<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="A proactive AI Chief of Staff"><link href=https://reubenjohn.github.io/reeve-bot/architecture/mcp-integration/ rel=canonical><link href=../pulse-queue/ rel=prev><link href=../daemon-api/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>MCP Integration - Project Reeve</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=deep-purple data-md-color-accent=amber> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#mcp-integration-design class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Project Reeve" class="md-header__button md-logo" aria-label="Project Reeve" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Project Reeve </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> MCP Integration </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme=default data-md-color-primary=deep-purple data-md-color-accent=amber aria-label="Switch to dark mode" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme=slate data-md-color-primary=deep-purple data-md-color-accent=amber aria-label="Switch to light mode" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/reubenjohn/reeve-bot title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> reubenjohn/reeve-bot </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Project Reeve" class="md-nav__button md-logo" aria-label="Project Reeve" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Project Reeve </label> <div class=md-nav__source> <a href=https://github.com/reubenjohn/reeve-bot title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </div> <div class=md-source__repository> reubenjohn/reeve-bot </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Home </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../project-structure/ class=md-nav__link> <span class=md-ellipsis> Project Structure </span> </a> </li> <li class=md-nav__item> <a href=../pulse-queue/ class=md-nav__link> <span class=md-ellipsis> Pulse Queue Design </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> MCP Integration </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> MCP Integration </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#mcp-server-1-pulse-queue-server class=md-nav__link> <span class=md-ellipsis> MCP Server 1: Pulse Queue Server </span> </a> <nav class=md-nav aria-label="MCP Server 1: Pulse Queue Server"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implementation class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mcp-server-2-telegram-notification-server class=md-nav__link> <span class=md-ellipsis> MCP Server 2: Telegram Notification Server </span> </a> <nav class=md-nav aria-label="MCP Server 2: Telegram Notification Server"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implementation_1 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> <nav class=md-nav aria-label=Configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mcp-client-configuration class=md-nav__link> <span class=md-ellipsis> MCP Client Configuration </span> </a> </li> <li class=md-nav__item> <a href=#environment-variables class=md-nav__link> <span class=md-ellipsis> Environment Variables </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#design-principles class=md-nav__link> <span class=md-ellipsis> Design Principles </span> </a> <nav class=md-nav aria-label="Design Principles"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-type-safety-with-pydantic class=md-nav__link> <span class=md-ellipsis> 1. Type Safety with Pydantic </span> </a> </li> <li class=md-nav__item> <a href=#2-comprehensive-documentation class=md-nav__link> <span class=md-ellipsis> 2. Comprehensive Documentation </span> </a> </li> <li class=md-nav__item> <a href=#3-user-friendly-formatting class=md-nav__link> <span class=md-ellipsis> 3. User-Friendly Formatting </span> </a> </li> <li class=md-nav__item> <a href=#4-error-handling class=md-nav__link> <span class=md-ellipsis> 4. Error Handling </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-mcp-tools class=md-nav__link> <span class=md-ellipsis> Testing MCP Tools </span> </a> <nav class=md-nav aria-label="Testing MCP Tools"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#manual-testing class=md-nav__link> <span class=md-ellipsis> Manual Testing </span> </a> </li> <li class=md-nav__item> <a href=#integration-testing class=md-nav__link> <span class=md-ellipsis> Integration Testing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../daemon-api/ class=md-nav__link> <span class=md-ellipsis> Daemon & API </span> </a> </li> <li class=md-nav__item> <a href=../deployment/ class=md-nav__link> <span class=md-ellipsis> Deployment </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex> <span class=md-ellipsis> Roadmap </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Roadmap </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../roadmap/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/phase-1-foundation/ class=md-nav__link> <span class=md-ellipsis> Phase 1 - Foundation </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/phase-2-queue/ class=md-nav__link> <span class=md-ellipsis> Phase 2 - Queue </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/phase-3-mcp/ class=md-nav__link> <span class=md-ellipsis> Phase 3 - MCP </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/phase-4-executor/ class=md-nav__link> <span class=md-ellipsis> Phase 4 - Executor </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/phase-5-daemon/ class=md-nav__link> <span class=md-ellipsis> Phase 5 - Daemon </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/phase-6-api/ class=md-nav__link> <span class=md-ellipsis> Phase 6 - API </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/phase-7-telegram/ class=md-nav__link> <span class=md-ellipsis> Phase 7 - Telegram </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/phase-8-deployment/ class=md-nav__link> <span class=md-ellipsis> Phase 8 - Deployment </span> </a> </li> <li class=md-nav__item> <a href=../../roadmap/phase-9-testing/ class=md-nav__link> <span class=md-ellipsis> Phase 9 - Testing </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex> <span class=md-ellipsis> Guides </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Guides </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../MCP_SETUP/ class=md-nav__link> <span class=md-ellipsis> MCP Setup </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5 id=__nav_5_label tabindex> <span class=md-ellipsis> Reference </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_5_label aria-expanded=false> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Reference </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../OpenClaw_COMPARISON/ class=md-nav__link> <span class=md-ellipsis> OpenClaw Comparison </span> </a> </li> <li class=md-nav__item> <a href=../../IDEAS/ class=md-nav__link> <span class=md-ellipsis> Ideas & Future </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://github.com/reubenjohn/reeve-bot/blob/master/CONTRIBUTING.md class=md-nav__link> <span class=md-ellipsis> Contributing </span> </a> </li> <li class=md-nav__item> <a href=https://github.com/reubenjohn/reeve-bot/blob/master/SECURITY.md class=md-nav__link> <span class=md-ellipsis> Security </span> </a> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#overview class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=#mcp-server-1-pulse-queue-server class=md-nav__link> <span class=md-ellipsis> MCP Server 1: Pulse Queue Server </span> </a> <nav class=md-nav aria-label="MCP Server 1: Pulse Queue Server"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implementation class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#mcp-server-2-telegram-notification-server class=md-nav__link> <span class=md-ellipsis> MCP Server 2: Telegram Notification Server </span> </a> <nav class=md-nav aria-label="MCP Server 2: Telegram Notification Server"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#implementation_1 class=md-nav__link> <span class=md-ellipsis> Implementation </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> <nav class=md-nav aria-label=Configuration> <ul class=md-nav__list> <li class=md-nav__item> <a href=#mcp-client-configuration class=md-nav__link> <span class=md-ellipsis> MCP Client Configuration </span> </a> </li> <li class=md-nav__item> <a href=#environment-variables class=md-nav__link> <span class=md-ellipsis> Environment Variables </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#design-principles class=md-nav__link> <span class=md-ellipsis> Design Principles </span> </a> <nav class=md-nav aria-label="Design Principles"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#1-type-safety-with-pydantic class=md-nav__link> <span class=md-ellipsis> 1. Type Safety with Pydantic </span> </a> </li> <li class=md-nav__item> <a href=#2-comprehensive-documentation class=md-nav__link> <span class=md-ellipsis> 2. Comprehensive Documentation </span> </a> </li> <li class=md-nav__item> <a href=#3-user-friendly-formatting class=md-nav__link> <span class=md-ellipsis> 3. User-Friendly Formatting </span> </a> </li> <li class=md-nav__item> <a href=#4-error-handling class=md-nav__link> <span class=md-ellipsis> 4. Error Handling </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-mcp-tools class=md-nav__link> <span class=md-ellipsis> Testing MCP Tools </span> </a> <nav class=md-nav aria-label="Testing MCP Tools"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#manual-testing class=md-nav__link> <span class=md-ellipsis> Manual Testing </span> </a> </li> <li class=md-nav__item> <a href=#integration-testing class=md-nav__link> <span class=md-ellipsis> Integration Testing </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#next-steps class=md-nav__link> <span class=md-ellipsis> Next Steps </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=mcp-integration-design>MCP Integration Design<a class=headerlink href=#mcp-integration-design title="Permanent link">&para;</a></h1> <h2 id=overview>Overview<a class=headerlink href=#overview title="Permanent link">&para;</a></h2> <p>This document specifies the MCP (Model Context Protocol) servers that Reeve uses to interact with the Pulse Queue system and send notifications. These servers expose tools that Reeve can call directly from within Hapi/Claude Code sessions.</p> <h2 id=mcp-server-1-pulse-queue-server>MCP Server 1: Pulse Queue Server<a class=headerlink href=#mcp-server-1-pulse-queue-server title="Permanent link">&para;</a></h2> <p><strong>Module</strong>: <code>src/reeve/mcp/pulse_server.py</code></p> <p><strong>Purpose</strong>: Allow Reeve to manage its own schedule by creating, viewing, and modifying pulses.</p> <p><strong>Connection Type</strong>: stdio (spawned on-demand by Reeve)</p> <h3 id=implementation>Implementation<a class=headerlink href=#implementation title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=sd>MCP Server for Pulse Queue Management</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=sd>This server exposes tools that allow Reeve (Claude Code) to proactively manage</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=sd>its own scheduling. Reeve can set alarms, check its upcoming schedule, and</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=sd>cancel or reschedule tasks.</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a><span class=sd>Usage:</span>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=sd>    Configure in ~/.config/claude-code/mcp_config.json:</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=sd>    {</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=sd>      &quot;mcpServers&quot;: {</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a><span class=sd>        &quot;pulse-queue&quot;: {</span>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=sd>          &quot;command&quot;: &quot;uv&quot;,</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=sd>          &quot;args&quot;: [&quot;run&quot;, &quot;--directory&quot;, &quot;/path/to/reeve-bot&quot;, &quot;python&quot;, &quot;-m&quot;, &quot;reeve.mcp.pulse_server&quot;]</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=sd>        }</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a><span class=sd>      }</span>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=sd>    }</span>
<a id=__codelineno-0-18 name=__codelineno-0-18 href=#__codelineno-0-18></a><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-0-19 name=__codelineno-0-19 href=#__codelineno-0-19></a>
<a id=__codelineno-0-20 name=__codelineno-0-20 href=#__codelineno-0-20></a><span class=kn>from</span><span class=w> </span><span class=nn>mcp.server</span><span class=w> </span><span class=kn>import</span> <span class=n>Server</span>
<a id=__codelineno-0-21 name=__codelineno-0-21 href=#__codelineno-0-21></a><span class=kn>from</span><span class=w> </span><span class=nn>mcp.server.stdio</span><span class=w> </span><span class=kn>import</span> <span class=n>stdio_server</span>
<a id=__codelineno-0-22 name=__codelineno-0-22 href=#__codelineno-0-22></a><span class=kn>from</span><span class=w> </span><span class=nn>mcp.types</span><span class=w> </span><span class=kn>import</span> <span class=n>TextContent</span>
<a id=__codelineno-0-23 name=__codelineno-0-23 href=#__codelineno-0-23></a><span class=kn>from</span><span class=w> </span><span class=nn>pydantic</span><span class=w> </span><span class=kn>import</span> <span class=n>Field</span>
<a id=__codelineno-0-24 name=__codelineno-0-24 href=#__codelineno-0-24></a><span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Annotated</span><span class=p>,</span> <span class=n>Literal</span><span class=p>,</span> <span class=n>Optional</span>
<a id=__codelineno-0-25 name=__codelineno-0-25 href=#__codelineno-0-25></a><span class=kn>from</span><span class=w> </span><span class=nn>datetime</span><span class=w> </span><span class=kn>import</span> <span class=n>datetime</span><span class=p>,</span> <span class=n>timezone</span><span class=p>,</span> <span class=n>timedelta</span>
<a id=__codelineno-0-26 name=__codelineno-0-26 href=#__codelineno-0-26></a><span class=kn>from</span><span class=w> </span><span class=nn>contextlib</span><span class=w> </span><span class=kn>import</span> <span class=n>asynccontextmanager</span>
<a id=__codelineno-0-27 name=__codelineno-0-27 href=#__codelineno-0-27></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<a id=__codelineno-0-28 name=__codelineno-0-28 href=#__codelineno-0-28></a>
<a id=__codelineno-0-29 name=__codelineno-0-29 href=#__codelineno-0-29></a><span class=kn>from</span><span class=w> </span><span class=nn>reeve.pulse.queue</span><span class=w> </span><span class=kn>import</span> <span class=n>PulseQueue</span>
<a id=__codelineno-0-30 name=__codelineno-0-30 href=#__codelineno-0-30></a><span class=kn>from</span><span class=w> </span><span class=nn>reeve.pulse.enums</span><span class=w> </span><span class=kn>import</span> <span class=n>PulsePriority</span><span class=p>,</span> <span class=n>PulseStatus</span>
<a id=__codelineno-0-31 name=__codelineno-0-31 href=#__codelineno-0-31></a>
<a id=__codelineno-0-32 name=__codelineno-0-32 href=#__codelineno-0-32></a><span class=c1># Initialize the MCP server</span>
<a id=__codelineno-0-33 name=__codelineno-0-33 href=#__codelineno-0-33></a><span class=n>app</span> <span class=o>=</span> <span class=n>Server</span><span class=p>(</span><span class=s2>&quot;pulse-queue&quot;</span><span class=p>)</span>
<a id=__codelineno-0-34 name=__codelineno-0-34 href=#__codelineno-0-34></a>
<a id=__codelineno-0-35 name=__codelineno-0-35 href=#__codelineno-0-35></a><span class=c1># Initialize the pulse queue (database connection)</span>
<a id=__codelineno-0-36 name=__codelineno-0-36 href=#__codelineno-0-36></a><span class=n>DB_PATH</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;PULSE_DB_PATH&quot;</span><span class=p>,</span> <span class=s2>&quot;~/.reeve/pulse_queue.db&quot;</span><span class=p>)</span>
<a id=__codelineno-0-37 name=__codelineno-0-37 href=#__codelineno-0-37></a><span class=n>queue</span> <span class=o>=</span> <span class=n>PulseQueue</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;sqlite+aiosqlite:///</span><span class=si>{</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>expanduser</span><span class=p>(</span><span class=n>DB_PATH</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-0-38 name=__codelineno-0-38 href=#__codelineno-0-38></a>
<a id=__codelineno-0-39 name=__codelineno-0-39 href=#__codelineno-0-39></a>
<a id=__codelineno-0-40 name=__codelineno-0-40 href=#__codelineno-0-40></a><span class=c1># ============================================================================</span>
<a id=__codelineno-0-41 name=__codelineno-0-41 href=#__codelineno-0-41></a><span class=c1># Tool Definitions</span>
<a id=__codelineno-0-42 name=__codelineno-0-42 href=#__codelineno-0-42></a><span class=c1># ============================================================================</span>
<a id=__codelineno-0-43 name=__codelineno-0-43 href=#__codelineno-0-43></a>
<a id=__codelineno-0-44 name=__codelineno-0-44 href=#__codelineno-0-44></a><span class=nd>@app</span><span class=o>.</span><span class=n>tool</span><span class=p>()</span>
<a id=__codelineno-0-45 name=__codelineno-0-45 href=#__codelineno-0-45></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>schedule_pulse</span><span class=p>(</span>
<a id=__codelineno-0-46 name=__codelineno-0-46 href=#__codelineno-0-46></a>    <span class=n>scheduled_at</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-47 name=__codelineno-0-47 href=#__codelineno-0-47></a>        <span class=nb>str</span><span class=p>,</span>
<a id=__codelineno-0-48 name=__codelineno-0-48 href=#__codelineno-0-48></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-49 name=__codelineno-0-49 href=#__codelineno-0-49></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-0-50 name=__codelineno-0-50 href=#__codelineno-0-50></a>                <span class=s2>&quot;When to execute this pulse. Accepts multiple formats:</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-51 name=__codelineno-0-51 href=#__codelineno-0-51></a>                <span class=s2>&quot;- ISO 8601 timestamp: &#39;2026-01-20T09:00:00Z&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-52 name=__codelineno-0-52 href=#__codelineno-0-52></a>                <span class=s2>&quot;- Relative time: &#39;in 2 hours&#39;, &#39;in 30 minutes&#39;, &#39;tomorrow at 9am&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-53 name=__codelineno-0-53 href=#__codelineno-0-53></a>                <span class=s2>&quot;- Special keywords: &#39;now&#39; (immediate), &#39;tonight&#39; (today at 10pm), &#39;tomorrow morning&#39; (tomorrow at 8am)</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-54 name=__codelineno-0-54 href=#__codelineno-0-54></a>                <span class=s2>&quot;IMPORTANT: All times are interpreted in the user&#39;s local timezone unless a UTC &#39;Z&#39; suffix is provided.&quot;</span>
<a id=__codelineno-0-55 name=__codelineno-0-55 href=#__codelineno-0-55></a>            <span class=p>),</span>
<a id=__codelineno-0-56 name=__codelineno-0-56 href=#__codelineno-0-56></a>            <span class=n>examples</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;2026-01-20T09:00:00Z&quot;</span><span class=p>,</span> <span class=s2>&quot;in 2 hours&quot;</span><span class=p>,</span> <span class=s2>&quot;tomorrow at 9am&quot;</span><span class=p>,</span> <span class=s2>&quot;now&quot;</span><span class=p>]</span>
<a id=__codelineno-0-57 name=__codelineno-0-57 href=#__codelineno-0-57></a>        <span class=p>)</span>
<a id=__codelineno-0-58 name=__codelineno-0-58 href=#__codelineno-0-58></a>    <span class=p>],</span>
<a id=__codelineno-0-59 name=__codelineno-0-59 href=#__codelineno-0-59></a>    <span class=n>prompt</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-60 name=__codelineno-0-60 href=#__codelineno-0-60></a>        <span class=nb>str</span><span class=p>,</span>
<a id=__codelineno-0-61 name=__codelineno-0-61 href=#__codelineno-0-61></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-62 name=__codelineno-0-62 href=#__codelineno-0-62></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-0-63 name=__codelineno-0-63 href=#__codelineno-0-63></a>                <span class=s2>&quot;The instruction or context for Reeve when this pulse fires. &quot;</span>
<a id=__codelineno-0-64 name=__codelineno-0-64 href=#__codelineno-0-64></a>                <span class=s2>&quot;This becomes the initial message in the spawned Hapi session.</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-65 name=__codelineno-0-65 href=#__codelineno-0-65></a>                <span class=s2>&quot;Be specific and action-oriented. Good examples:</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-66 name=__codelineno-0-66 href=#__codelineno-0-66></a>                <span class=s2>&quot;- &#39;Check flight status for UA123 and notify user if delayed&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-67 name=__codelineno-0-67 href=#__codelineno-0-67></a>                <span class=s2>&quot;- &#39;Daily morning briefing: review calendar, check email, summarize priorities&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-68 name=__codelineno-0-68 href=#__codelineno-0-68></a>                <span class=s2>&quot;- &#39;Follow up: Did user reply to the snowboarding trip proposal?&#39;</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-69 name=__codelineno-0-69 href=#__codelineno-0-69></a>                <span class=s2>&quot;Avoid vague prompts like &#39;check things&#39; or &#39;do stuff&#39;.&quot;</span>
<a id=__codelineno-0-70 name=__codelineno-0-70 href=#__codelineno-0-70></a>            <span class=p>),</span>
<a id=__codelineno-0-71 name=__codelineno-0-71 href=#__codelineno-0-71></a>            <span class=n>min_length</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span>
<a id=__codelineno-0-72 name=__codelineno-0-72 href=#__codelineno-0-72></a>            <span class=n>max_length</span><span class=o>=</span><span class=mi>2000</span>
<a id=__codelineno-0-73 name=__codelineno-0-73 href=#__codelineno-0-73></a>        <span class=p>)</span>
<a id=__codelineno-0-74 name=__codelineno-0-74 href=#__codelineno-0-74></a>    <span class=p>],</span>
<a id=__codelineno-0-75 name=__codelineno-0-75 href=#__codelineno-0-75></a>    <span class=n>priority</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-76 name=__codelineno-0-76 href=#__codelineno-0-76></a>        <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;critical&quot;</span><span class=p>,</span> <span class=s2>&quot;high&quot;</span><span class=p>,</span> <span class=s2>&quot;normal&quot;</span><span class=p>,</span> <span class=s2>&quot;low&quot;</span><span class=p>,</span> <span class=s2>&quot;deferred&quot;</span><span class=p>],</span>
<a id=__codelineno-0-77 name=__codelineno-0-77 href=#__codelineno-0-77></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-78 name=__codelineno-0-78 href=#__codelineno-0-78></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-0-79 name=__codelineno-0-79 href=#__codelineno-0-79></a>                <span class=s2>&quot;Urgency level for this pulse. Determines execution order when multiple pulses are due:</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-80 name=__codelineno-0-80 href=#__codelineno-0-80></a>                <span class=s2>&quot;- &#39;critical&#39; (üö®): Emergencies, user messages, system failures. Interrupts deep work.</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-81 name=__codelineno-0-81 href=#__codelineno-0-81></a>                <span class=s2>&quot;- &#39;high&#39; (üîî): Important external events, user-facing tasks, scheduled alarms.</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-82 name=__codelineno-0-82 href=#__codelineno-0-82></a>                <span class=s2>&quot;- &#39;normal&#39; (‚è∞): Regular maintenance, periodic checks, calendar reminders. (DEFAULT)</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-83 name=__codelineno-0-83 href=#__codelineno-0-83></a>                <span class=s2>&quot;- &#39;low&#39; (üìã): Background tasks, cleanup, non-urgent maintenance.</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-84 name=__codelineno-0-84 href=#__codelineno-0-84></a>                <span class=s2>&quot;- &#39;deferred&#39; (üïê): Intentionally postponed tasks, snoozed items.</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-85 name=__codelineno-0-85 href=#__codelineno-0-85></a>                <span class=s2>&quot;Default: &#39;normal&#39;&quot;</span>
<a id=__codelineno-0-86 name=__codelineno-0-86 href=#__codelineno-0-86></a>            <span class=p>),</span>
<a id=__codelineno-0-87 name=__codelineno-0-87 href=#__codelineno-0-87></a>        <span class=p>)</span>
<a id=__codelineno-0-88 name=__codelineno-0-88 href=#__codelineno-0-88></a>    <span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;normal&quot;</span><span class=p>,</span>
<a id=__codelineno-0-89 name=__codelineno-0-89 href=#__codelineno-0-89></a>    <span class=n>resume_in_current_session</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-90 name=__codelineno-0-90 href=#__codelineno-0-90></a>        <span class=nb>bool</span><span class=p>,</span>
<a id=__codelineno-0-91 name=__codelineno-0-91 href=#__codelineno-0-91></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-92 name=__codelineno-0-92 href=#__codelineno-0-92></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-0-93 name=__codelineno-0-93 href=#__codelineno-0-93></a>                <span class=s2>&quot;Whether to resume the pulse in the current session (default: False).</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-94 name=__codelineno-0-94 href=#__codelineno-0-94></a>                <span class=s2>&quot;- False (default): The pulse starts a brand new session. Recommended for most use cases.</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-95 name=__codelineno-0-95 href=#__codelineno-0-95></a>                <span class=s2>&quot;- True: The pulse resumes in the current session, injecting the prompt as if it were a new user message at the scheduled time.</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-96 name=__codelineno-0-96 href=#__codelineno-0-96></a>                <span class=s2>&quot;WARNING: Setting this to True means the prompt will be injected into the current session context. &quot;</span>
<a id=__codelineno-0-97 name=__codelineno-0-97 href=#__codelineno-0-97></a>                <span class=s2>&quot;This is useful when there&#39;s rich context to preserve, but be careful - if the user advances the conversation, &quot;</span>
<a id=__codelineno-0-98 name=__codelineno-0-98 href=#__codelineno-0-98></a>                <span class=s2>&quot;the pulse prompt might not be relevant anymore.&quot;</span>
<a id=__codelineno-0-99 name=__codelineno-0-99 href=#__codelineno-0-99></a>            <span class=p>),</span>
<a id=__codelineno-0-100 name=__codelineno-0-100 href=#__codelineno-0-100></a>        <span class=p>)</span>
<a id=__codelineno-0-101 name=__codelineno-0-101 href=#__codelineno-0-101></a>    <span class=p>]</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-102 name=__codelineno-0-102 href=#__codelineno-0-102></a>    <span class=n>sticky_notes</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-103 name=__codelineno-0-103 href=#__codelineno-0-103></a>        <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]],</span>
<a id=__codelineno-0-104 name=__codelineno-0-104 href=#__codelineno-0-104></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-105 name=__codelineno-0-105 href=#__codelineno-0-105></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-0-106 name=__codelineno-0-106 href=#__codelineno-0-106></a>                <span class=s2>&quot;Optional list of reminder strings to inject into the prompt when the pulse fires. &quot;</span>
<a id=__codelineno-0-107 name=__codelineno-0-107 href=#__codelineno-0-107></a>                <span class=s2>&quot;Use this to carry forward context between pulses.</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-108 name=__codelineno-0-108 href=#__codelineno-0-108></a>                <span class=s2>&quot;Examples:</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-109 name=__codelineno-0-109 href=#__codelineno-0-109></a>                <span class=s2>&quot;- [&#39;User asked about snowboarding trip on Monday&#39;, &#39;Check if anyone replied in group chat&#39;]</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-110 name=__codelineno-0-110 href=#__codelineno-0-110></a>                <span class=s2>&quot;- [&#39;Flight departs at 6:45 AM&#39;, &#39;TSA PreCheck lane available&#39;]</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-111 name=__codelineno-0-111 href=#__codelineno-0-111></a>                <span class=s2>&quot;These will be prepended to the main prompt with clear formatting.&quot;</span>
<a id=__codelineno-0-112 name=__codelineno-0-112 href=#__codelineno-0-112></a>            <span class=p>),</span>
<a id=__codelineno-0-113 name=__codelineno-0-113 href=#__codelineno-0-113></a>        <span class=p>)</span>
<a id=__codelineno-0-114 name=__codelineno-0-114 href=#__codelineno-0-114></a>    <span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-115 name=__codelineno-0-115 href=#__codelineno-0-115></a>    <span class=n>tags</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-116 name=__codelineno-0-116 href=#__codelineno-0-116></a>        <span class=n>Optional</span><span class=p>[</span><span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]],</span>
<a id=__codelineno-0-117 name=__codelineno-0-117 href=#__codelineno-0-117></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-118 name=__codelineno-0-118 href=#__codelineno-0-118></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-0-119 name=__codelineno-0-119 href=#__codelineno-0-119></a>                <span class=s2>&quot;Optional categorization tags for filtering and organization. &quot;</span>
<a id=__codelineno-0-120 name=__codelineno-0-120 href=#__codelineno-0-120></a>                <span class=s2>&quot;Useful for querying related pulses or understanding patterns.</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-121 name=__codelineno-0-121 href=#__codelineno-0-121></a>                <span class=s2>&quot;Examples: [&#39;daily&#39;, &#39;morning_routine&#39;], [&#39;trip_planning&#39;, &#39;japan&#39;], [&#39;follow_up&#39;, &#39;github&#39;]&quot;</span>
<a id=__codelineno-0-122 name=__codelineno-0-122 href=#__codelineno-0-122></a>            <span class=p>),</span>
<a id=__codelineno-0-123 name=__codelineno-0-123 href=#__codelineno-0-123></a>        <span class=p>)</span>
<a id=__codelineno-0-124 name=__codelineno-0-124 href=#__codelineno-0-124></a>    <span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-0-125 name=__codelineno-0-125 href=#__codelineno-0-125></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-0-126 name=__codelineno-0-126 href=#__codelineno-0-126></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-0-127 name=__codelineno-0-127 href=#__codelineno-0-127></a><span class=sd>    Schedule a new pulse (wake-up event) for Reeve.</span>
<a id=__codelineno-0-128 name=__codelineno-0-128 href=#__codelineno-0-128></a>
<a id=__codelineno-0-129 name=__codelineno-0-129 href=#__codelineno-0-129></a><span class=sd>    This is Reeve&#39;s primary tool for proactive behavior. Use this to schedule</span>
<a id=__codelineno-0-130 name=__codelineno-0-130 href=#__codelineno-0-130></a><span class=sd>    future tasks, set reminders, or create follow-up checks.</span>
<a id=__codelineno-0-131 name=__codelineno-0-131 href=#__codelineno-0-131></a>
<a id=__codelineno-0-132 name=__codelineno-0-132 href=#__codelineno-0-132></a><span class=sd>    When to use:</span>
<a id=__codelineno-0-133 name=__codelineno-0-133 href=#__codelineno-0-133></a><span class=sd>    - Set alarms: &quot;Remind me to check ticket prices tomorrow at 8am&quot;</span>
<a id=__codelineno-0-134 name=__codelineno-0-134 href=#__codelineno-0-134></a><span class=sd>    - Schedule follow-ups: &quot;Check if user replied in 2 hours&quot;</span>
<a id=__codelineno-0-135 name=__codelineno-0-135 href=#__codelineno-0-135></a><span class=sd>    - Create recurring checks: &quot;Every morning at 9am, review calendar&quot;</span>
<a id=__codelineno-0-136 name=__codelineno-0-136 href=#__codelineno-0-136></a><span class=sd>    - Defer tasks: &quot;I can&#39;t handle this now, wake me up tonight to finish&quot;</span>
<a id=__codelineno-0-137 name=__codelineno-0-137 href=#__codelineno-0-137></a>
<a id=__codelineno-0-138 name=__codelineno-0-138 href=#__codelineno-0-138></a><span class=sd>    When NOT to use:</span>
<a id=__codelineno-0-139 name=__codelineno-0-139 href=#__codelineno-0-139></a><span class=sd>    - Immediate actions (just do them now)</span>
<a id=__codelineno-0-140 name=__codelineno-0-140 href=#__codelineno-0-140></a><span class=sd>    - One-time informational tasks (use memory/notes instead)</span>
<a id=__codelineno-0-141 name=__codelineno-0-141 href=#__codelineno-0-141></a>
<a id=__codelineno-0-142 name=__codelineno-0-142 href=#__codelineno-0-142></a><span class=sd>    Examples:</span>
<a id=__codelineno-0-143 name=__codelineno-0-143 href=#__codelineno-0-143></a><span class=sd>        # Set a morning briefing</span>
<a id=__codelineno-0-144 name=__codelineno-0-144 href=#__codelineno-0-144></a><span class=sd>        schedule_pulse(</span>
<a id=__codelineno-0-145 name=__codelineno-0-145 href=#__codelineno-0-145></a><span class=sd>            scheduled_at=&quot;tomorrow at 9am&quot;,</span>
<a id=__codelineno-0-146 name=__codelineno-0-146 href=#__codelineno-0-146></a><span class=sd>            prompt=&quot;Daily morning briefing: review calendar, check email, summarize priorities&quot;,</span>
<a id=__codelineno-0-147 name=__codelineno-0-147 href=#__codelineno-0-147></a><span class=sd>            priority=&quot;normal&quot;,</span>
<a id=__codelineno-0-148 name=__codelineno-0-148 href=#__codelineno-0-148></a><span class=sd>            tags=[&quot;daily&quot;, &quot;morning_routine&quot;]</span>
<a id=__codelineno-0-149 name=__codelineno-0-149 href=#__codelineno-0-149></a><span class=sd>        )</span>
<a id=__codelineno-0-150 name=__codelineno-0-150 href=#__codelineno-0-150></a>
<a id=__codelineno-0-151 name=__codelineno-0-151 href=#__codelineno-0-151></a><span class=sd>        # Follow up on a pending task</span>
<a id=__codelineno-0-152 name=__codelineno-0-152 href=#__codelineno-0-152></a><span class=sd>        schedule_pulse(</span>
<a id=__codelineno-0-153 name=__codelineno-0-153 href=#__codelineno-0-153></a><span class=sd>            scheduled_at=&quot;in 2 hours&quot;,</span>
<a id=__codelineno-0-154 name=__codelineno-0-154 href=#__codelineno-0-154></a><span class=sd>            prompt=&quot;Check if user replied to the snowboarding trip proposal in group chat&quot;,</span>
<a id=__codelineno-0-155 name=__codelineno-0-155 href=#__codelineno-0-155></a><span class=sd>            priority=&quot;high&quot;,</span>
<a id=__codelineno-0-156 name=__codelineno-0-156 href=#__codelineno-0-156></a><span class=sd>            sticky_notes=[&quot;Sent message at 2:30 PM&quot;, &quot;Waiting for Alex and Jamie to confirm&quot;],</span>
<a id=__codelineno-0-157 name=__codelineno-0-157 href=#__codelineno-0-157></a><span class=sd>            tags=[&quot;follow_up&quot;, &quot;social&quot;]</span>
<a id=__codelineno-0-158 name=__codelineno-0-158 href=#__codelineno-0-158></a><span class=sd>        )</span>
<a id=__codelineno-0-159 name=__codelineno-0-159 href=#__codelineno-0-159></a>
<a id=__codelineno-0-160 name=__codelineno-0-160 href=#__codelineno-0-160></a><span class=sd>        # Critical pre-departure check</span>
<a id=__codelineno-0-161 name=__codelineno-0-161 href=#__codelineno-0-161></a><span class=sd>        schedule_pulse(</span>
<a id=__codelineno-0-162 name=__codelineno-0-162 href=#__codelineno-0-162></a><span class=sd>            scheduled_at=&quot;2026-01-20T06:00:00Z&quot;,</span>
<a id=__codelineno-0-163 name=__codelineno-0-163 href=#__codelineno-0-163></a><span class=sd>            prompt=&quot;Check flight status for UA123 and notify user immediately if delayed&quot;,</span>
<a id=__codelineno-0-164 name=__codelineno-0-164 href=#__codelineno-0-164></a><span class=sd>            priority=&quot;critical&quot;,</span>
<a id=__codelineno-0-165 name=__codelineno-0-165 href=#__codelineno-0-165></a><span class=sd>            tags=[&quot;travel&quot;, &quot;urgent&quot;]</span>
<a id=__codelineno-0-166 name=__codelineno-0-166 href=#__codelineno-0-166></a><span class=sd>        )</span>
<a id=__codelineno-0-167 name=__codelineno-0-167 href=#__codelineno-0-167></a>
<a id=__codelineno-0-168 name=__codelineno-0-168 href=#__codelineno-0-168></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-169 name=__codelineno-0-169 href=#__codelineno-0-169></a><span class=sd>        Confirmation message with the pulse ID and scheduled time</span>
<a id=__codelineno-0-170 name=__codelineno-0-170 href=#__codelineno-0-170></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-171 name=__codelineno-0-171 href=#__codelineno-0-171></a>    <span class=c1># Parse scheduled_at (handle relative times, keywords, etc.)</span>
<a id=__codelineno-0-172 name=__codelineno-0-172 href=#__codelineno-0-172></a>    <span class=n>parsed_time</span> <span class=o>=</span> <span class=n>_parse_time_string</span><span class=p>(</span><span class=n>scheduled_at</span><span class=p>)</span>
<a id=__codelineno-0-173 name=__codelineno-0-173 href=#__codelineno-0-173></a>
<a id=__codelineno-0-174 name=__codelineno-0-174 href=#__codelineno-0-174></a>    <span class=c1># Determine session ID based on resume_in_current_session</span>
<a id=__codelineno-0-175 name=__codelineno-0-175 href=#__codelineno-0-175></a>    <span class=n>session_id</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-0-176 name=__codelineno-0-176 href=#__codelineno-0-176></a>    <span class=k>if</span> <span class=n>resume_in_current_session</span><span class=p>:</span>
<a id=__codelineno-0-177 name=__codelineno-0-177 href=#__codelineno-0-177></a>        <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-0-178 name=__codelineno-0-178 href=#__codelineno-0-178></a>            <span class=n>session_id</span> <span class=o>=</span> <span class=n>ctx</span><span class=o>.</span><span class=n>session_id</span>
<a id=__codelineno-0-179 name=__codelineno-0-179 href=#__codelineno-0-179></a>        <span class=k>except</span> <span class=p>(</span><span class=ne>RuntimeError</span><span class=p>,</span> <span class=ne>AttributeError</span><span class=p>):</span>
<a id=__codelineno-0-180 name=__codelineno-0-180 href=#__codelineno-0-180></a>            <span class=c1># Session ID not available - fall back to new session</span>
<a id=__codelineno-0-181 name=__codelineno-0-181 href=#__codelineno-0-181></a>            <span class=k>pass</span>
<a id=__codelineno-0-182 name=__codelineno-0-182 href=#__codelineno-0-182></a>
<a id=__codelineno-0-183 name=__codelineno-0-183 href=#__codelineno-0-183></a>    <span class=c1># Create the pulse</span>
<a id=__codelineno-0-184 name=__codelineno-0-184 href=#__codelineno-0-184></a>    <span class=n>pulse_id</span> <span class=o>=</span> <span class=k>await</span> <span class=n>queue</span><span class=o>.</span><span class=n>schedule_pulse</span><span class=p>(</span>
<a id=__codelineno-0-185 name=__codelineno-0-185 href=#__codelineno-0-185></a>        <span class=n>scheduled_at</span><span class=o>=</span><span class=n>parsed_time</span><span class=p>,</span>
<a id=__codelineno-0-186 name=__codelineno-0-186 href=#__codelineno-0-186></a>        <span class=n>prompt</span><span class=o>=</span><span class=n>prompt</span><span class=p>,</span>
<a id=__codelineno-0-187 name=__codelineno-0-187 href=#__codelineno-0-187></a>        <span class=n>priority</span><span class=o>=</span><span class=n>PulsePriority</span><span class=p>(</span><span class=n>priority</span><span class=p>),</span>
<a id=__codelineno-0-188 name=__codelineno-0-188 href=#__codelineno-0-188></a>        <span class=n>session_id</span><span class=o>=</span><span class=n>session_id</span><span class=p>,</span>
<a id=__codelineno-0-189 name=__codelineno-0-189 href=#__codelineno-0-189></a>        <span class=n>sticky_notes</span><span class=o>=</span><span class=n>sticky_notes</span><span class=p>,</span>
<a id=__codelineno-0-190 name=__codelineno-0-190 href=#__codelineno-0-190></a>        <span class=n>tags</span><span class=o>=</span><span class=n>tags</span><span class=p>,</span>
<a id=__codelineno-0-191 name=__codelineno-0-191 href=#__codelineno-0-191></a>        <span class=n>created_by</span><span class=o>=</span><span class=s2>&quot;reeve&quot;</span><span class=p>,</span>
<a id=__codelineno-0-192 name=__codelineno-0-192 href=#__codelineno-0-192></a>    <span class=p>)</span>
<a id=__codelineno-0-193 name=__codelineno-0-193 href=#__codelineno-0-193></a>
<a id=__codelineno-0-194 name=__codelineno-0-194 href=#__codelineno-0-194></a>    <span class=c1># Format response</span>
<a id=__codelineno-0-195 name=__codelineno-0-195 href=#__codelineno-0-195></a>    <span class=n>time_str</span> <span class=o>=</span> <span class=n>parsed_time</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&quot;%Y-%m-</span><span class=si>%d</span><span class=s2> %H:%M:%S %Z&quot;</span><span class=p>)</span>
<a id=__codelineno-0-196 name=__codelineno-0-196 href=#__codelineno-0-196></a>    <span class=k>return</span> <span class=p>(</span>
<a id=__codelineno-0-197 name=__codelineno-0-197 href=#__codelineno-0-197></a>        <span class=sa>f</span><span class=s2>&quot;‚úì Pulse scheduled successfully</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-198 name=__codelineno-0-198 href=#__codelineno-0-198></a>        <span class=sa>f</span><span class=s2>&quot;Pulse ID: </span><span class=si>{</span><span class=n>pulse_id</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-199 name=__codelineno-0-199 href=#__codelineno-0-199></a>        <span class=sa>f</span><span class=s2>&quot;Scheduled: </span><span class=si>{</span><span class=n>time_str</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-200 name=__codelineno-0-200 href=#__codelineno-0-200></a>        <span class=sa>f</span><span class=s2>&quot;Priority: </span><span class=si>{</span><span class=n>priority</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>_priority_emoji</span><span class=p>(</span><span class=n>priority</span><span class=p>)</span><span class=si>}</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-201 name=__codelineno-0-201 href=#__codelineno-0-201></a>        <span class=sa>f</span><span class=s2>&quot;Prompt: </span><span class=si>{</span><span class=n>prompt</span><span class=p>[:</span><span class=mi>100</span><span class=p>]</span><span class=si>}{</span><span class=s1>&#39;...&#39;</span><span class=w> </span><span class=k>if</span><span class=w> </span><span class=nb>len</span><span class=p>(</span><span class=n>prompt</span><span class=p>)</span><span class=w> </span><span class=o>&gt;</span><span class=w> </span><span class=mi>100</span><span class=w> </span><span class=k>else</span><span class=w> </span><span class=s1>&#39;&#39;</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-202 name=__codelineno-0-202 href=#__codelineno-0-202></a>    <span class=p>)</span>
<a id=__codelineno-0-203 name=__codelineno-0-203 href=#__codelineno-0-203></a>
<a id=__codelineno-0-204 name=__codelineno-0-204 href=#__codelineno-0-204></a>
<a id=__codelineno-0-205 name=__codelineno-0-205 href=#__codelineno-0-205></a><span class=nd>@app</span><span class=o>.</span><span class=n>tool</span><span class=p>()</span>
<a id=__codelineno-0-206 name=__codelineno-0-206 href=#__codelineno-0-206></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>list_upcoming_pulses</span><span class=p>(</span>
<a id=__codelineno-0-207 name=__codelineno-0-207 href=#__codelineno-0-207></a>    <span class=n>limit</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-208 name=__codelineno-0-208 href=#__codelineno-0-208></a>        <span class=nb>int</span><span class=p>,</span>
<a id=__codelineno-0-209 name=__codelineno-0-209 href=#__codelineno-0-209></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-210 name=__codelineno-0-210 href=#__codelineno-0-210></a>            <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Maximum number of pulses to return (default: 20, max: 100)&quot;</span><span class=p>,</span>
<a id=__codelineno-0-211 name=__codelineno-0-211 href=#__codelineno-0-211></a>            <span class=n>ge</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-0-212 name=__codelineno-0-212 href=#__codelineno-0-212></a>            <span class=n>le</span><span class=o>=</span><span class=mi>100</span>
<a id=__codelineno-0-213 name=__codelineno-0-213 href=#__codelineno-0-213></a>        <span class=p>)</span>
<a id=__codelineno-0-214 name=__codelineno-0-214 href=#__codelineno-0-214></a>    <span class=p>]</span> <span class=o>=</span> <span class=mi>20</span><span class=p>,</span>
<a id=__codelineno-0-215 name=__codelineno-0-215 href=#__codelineno-0-215></a>    <span class=n>include_completed</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-216 name=__codelineno-0-216 href=#__codelineno-0-216></a>        <span class=nb>bool</span><span class=p>,</span>
<a id=__codelineno-0-217 name=__codelineno-0-217 href=#__codelineno-0-217></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-218 name=__codelineno-0-218 href=#__codelineno-0-218></a>            <span class=n>description</span><span class=o>=</span><span class=s2>&quot;Whether to include recently completed pulses (default: False, only show pending)&quot;</span>
<a id=__codelineno-0-219 name=__codelineno-0-219 href=#__codelineno-0-219></a>        <span class=p>)</span>
<a id=__codelineno-0-220 name=__codelineno-0-220 href=#__codelineno-0-220></a>    <span class=p>]</span> <span class=o>=</span> <span class=kc>False</span><span class=p>,</span>
<a id=__codelineno-0-221 name=__codelineno-0-221 href=#__codelineno-0-221></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-0-222 name=__codelineno-0-222 href=#__codelineno-0-222></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-0-223 name=__codelineno-0-223 href=#__codelineno-0-223></a><span class=sd>    List upcoming scheduled pulses.</span>
<a id=__codelineno-0-224 name=__codelineno-0-224 href=#__codelineno-0-224></a>
<a id=__codelineno-0-225 name=__codelineno-0-225 href=#__codelineno-0-225></a><span class=sd>    Use this to check Reeve&#39;s schedule and understand what tasks are coming up.</span>
<a id=__codelineno-0-226 name=__codelineno-0-226 href=#__codelineno-0-226></a><span class=sd>    Useful for:</span>
<a id=__codelineno-0-227 name=__codelineno-0-227 href=#__codelineno-0-227></a><span class=sd>    - Seeing what&#39;s on the agenda</span>
<a id=__codelineno-0-228 name=__codelineno-0-228 href=#__codelineno-0-228></a><span class=sd>    - Verifying a pulse was scheduled correctly</span>
<a id=__codelineno-0-229 name=__codelineno-0-229 href=#__codelineno-0-229></a><span class=sd>    - Detecting scheduling conflicts</span>
<a id=__codelineno-0-230 name=__codelineno-0-230 href=#__codelineno-0-230></a><span class=sd>    - Understanding workload distribution</span>
<a id=__codelineno-0-231 name=__codelineno-0-231 href=#__codelineno-0-231></a>
<a id=__codelineno-0-232 name=__codelineno-0-232 href=#__codelineno-0-232></a><span class=sd>    Examples:</span>
<a id=__codelineno-0-233 name=__codelineno-0-233 href=#__codelineno-0-233></a><span class=sd>        # Check what&#39;s coming up</span>
<a id=__codelineno-0-234 name=__codelineno-0-234 href=#__codelineno-0-234></a><span class=sd>        list_upcoming_pulses(limit=10)</span>
<a id=__codelineno-0-235 name=__codelineno-0-235 href=#__codelineno-0-235></a>
<a id=__codelineno-0-236 name=__codelineno-0-236 href=#__codelineno-0-236></a><span class=sd>        # Review recent history</span>
<a id=__codelineno-0-237 name=__codelineno-0-237 href=#__codelineno-0-237></a><span class=sd>        list_upcoming_pulses(limit=20, include_completed=True)</span>
<a id=__codelineno-0-238 name=__codelineno-0-238 href=#__codelineno-0-238></a>
<a id=__codelineno-0-239 name=__codelineno-0-239 href=#__codelineno-0-239></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-240 name=__codelineno-0-240 href=#__codelineno-0-240></a><span class=sd>        Formatted list of pulses with time, priority, and prompt preview</span>
<a id=__codelineno-0-241 name=__codelineno-0-241 href=#__codelineno-0-241></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-242 name=__codelineno-0-242 href=#__codelineno-0-242></a>    <span class=n>statuses</span> <span class=o>=</span> <span class=p>[</span><span class=n>PulseStatus</span><span class=o>.</span><span class=n>PENDING</span><span class=p>]</span>
<a id=__codelineno-0-243 name=__codelineno-0-243 href=#__codelineno-0-243></a>    <span class=k>if</span> <span class=n>include_completed</span><span class=p>:</span>
<a id=__codelineno-0-244 name=__codelineno-0-244 href=#__codelineno-0-244></a>        <span class=n>statuses</span><span class=o>.</span><span class=n>extend</span><span class=p>([</span><span class=n>PulseStatus</span><span class=o>.</span><span class=n>COMPLETED</span><span class=p>,</span> <span class=n>PulseStatus</span><span class=o>.</span><span class=n>PROCESSING</span><span class=p>])</span>
<a id=__codelineno-0-245 name=__codelineno-0-245 href=#__codelineno-0-245></a>
<a id=__codelineno-0-246 name=__codelineno-0-246 href=#__codelineno-0-246></a>    <span class=n>pulses</span> <span class=o>=</span> <span class=k>await</span> <span class=n>queue</span><span class=o>.</span><span class=n>get_upcoming_pulses</span><span class=p>(</span><span class=n>limit</span><span class=o>=</span><span class=n>limit</span><span class=p>,</span> <span class=n>include_statuses</span><span class=o>=</span><span class=n>statuses</span><span class=p>)</span>
<a id=__codelineno-0-247 name=__codelineno-0-247 href=#__codelineno-0-247></a>
<a id=__codelineno-0-248 name=__codelineno-0-248 href=#__codelineno-0-248></a>    <span class=k>if</span> <span class=ow>not</span> <span class=n>pulses</span><span class=p>:</span>
<a id=__codelineno-0-249 name=__codelineno-0-249 href=#__codelineno-0-249></a>        <span class=k>return</span> <span class=s2>&quot;No upcoming pulses scheduled. The schedule is clear.&quot;</span>
<a id=__codelineno-0-250 name=__codelineno-0-250 href=#__codelineno-0-250></a>
<a id=__codelineno-0-251 name=__codelineno-0-251 href=#__codelineno-0-251></a>    <span class=c1># Format as a table</span>
<a id=__codelineno-0-252 name=__codelineno-0-252 href=#__codelineno-0-252></a>    <span class=n>lines</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&quot;Upcoming Pulses:</span><span class=se>\n</span><span class=s2>&quot;</span><span class=p>]</span>
<a id=__codelineno-0-253 name=__codelineno-0-253 href=#__codelineno-0-253></a>    <span class=n>now</span> <span class=o>=</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>timezone</span><span class=o>.</span><span class=n>utc</span><span class=p>)</span>
<a id=__codelineno-0-254 name=__codelineno-0-254 href=#__codelineno-0-254></a>
<a id=__codelineno-0-255 name=__codelineno-0-255 href=#__codelineno-0-255></a>    <span class=k>for</span> <span class=n>pulse</span> <span class=ow>in</span> <span class=n>pulses</span><span class=p>:</span>
<a id=__codelineno-0-256 name=__codelineno-0-256 href=#__codelineno-0-256></a>        <span class=c1># Calculate time until pulse</span>
<a id=__codelineno-0-257 name=__codelineno-0-257 href=#__codelineno-0-257></a>        <span class=n>time_delta</span> <span class=o>=</span> <span class=n>pulse</span><span class=o>.</span><span class=n>scheduled_at</span> <span class=o>-</span> <span class=n>now</span>
<a id=__codelineno-0-258 name=__codelineno-0-258 href=#__codelineno-0-258></a>        <span class=k>if</span> <span class=n>time_delta</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>&lt;</span> <span class=mi>0</span><span class=p>:</span>
<a id=__codelineno-0-259 name=__codelineno-0-259 href=#__codelineno-0-259></a>            <span class=n>time_str</span> <span class=o>=</span> <span class=s2>&quot;OVERDUE&quot;</span>
<a id=__codelineno-0-260 name=__codelineno-0-260 href=#__codelineno-0-260></a>        <span class=k>elif</span> <span class=n>time_delta</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>&lt;</span> <span class=mi>3600</span><span class=p>:</span>
<a id=__codelineno-0-261 name=__codelineno-0-261 href=#__codelineno-0-261></a>            <span class=n>time_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;in </span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>time_delta</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>60</span><span class=p>)</span><span class=si>}</span><span class=s2>m&quot;</span>
<a id=__codelineno-0-262 name=__codelineno-0-262 href=#__codelineno-0-262></a>        <span class=k>elif</span> <span class=n>time_delta</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span> <span class=o>&lt;</span> <span class=mi>86400</span><span class=p>:</span>
<a id=__codelineno-0-263 name=__codelineno-0-263 href=#__codelineno-0-263></a>            <span class=n>time_str</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;in </span><span class=si>{</span><span class=nb>int</span><span class=p>(</span><span class=n>time_delta</span><span class=o>.</span><span class=n>total_seconds</span><span class=p>()</span><span class=w> </span><span class=o>/</span><span class=w> </span><span class=mi>3600</span><span class=p>)</span><span class=si>}</span><span class=s2>h&quot;</span>
<a id=__codelineno-0-264 name=__codelineno-0-264 href=#__codelineno-0-264></a>        <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-265 name=__codelineno-0-265 href=#__codelineno-0-265></a>            <span class=n>time_str</span> <span class=o>=</span> <span class=n>pulse</span><span class=o>.</span><span class=n>scheduled_at</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&quot;%b </span><span class=si>%d</span><span class=s2> %H:%M&quot;</span><span class=p>)</span>
<a id=__codelineno-0-266 name=__codelineno-0-266 href=#__codelineno-0-266></a>
<a id=__codelineno-0-267 name=__codelineno-0-267 href=#__codelineno-0-267></a>        <span class=n>emoji</span> <span class=o>=</span> <span class=n>_priority_emoji</span><span class=p>(</span><span class=n>pulse</span><span class=o>.</span><span class=n>priority</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
<a id=__codelineno-0-268 name=__codelineno-0-268 href=#__codelineno-0-268></a>        <span class=n>status_emoji</span> <span class=o>=</span> <span class=n>_status_emoji</span><span class=p>(</span><span class=n>pulse</span><span class=o>.</span><span class=n>status</span><span class=o>.</span><span class=n>value</span><span class=p>)</span>
<a id=__codelineno-0-269 name=__codelineno-0-269 href=#__codelineno-0-269></a>        <span class=n>prompt_preview</span> <span class=o>=</span> <span class=n>pulse</span><span class=o>.</span><span class=n>prompt</span><span class=p>[:</span><span class=mi>60</span><span class=p>]</span> <span class=o>+</span> <span class=s2>&quot;...&quot;</span> <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>pulse</span><span class=o>.</span><span class=n>prompt</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>60</span> <span class=k>else</span> <span class=n>pulse</span><span class=o>.</span><span class=n>prompt</span>
<a id=__codelineno-0-270 name=__codelineno-0-270 href=#__codelineno-0-270></a>
<a id=__codelineno-0-271 name=__codelineno-0-271 href=#__codelineno-0-271></a>        <span class=n>lines</span><span class=o>.</span><span class=n>append</span><span class=p>(</span>
<a id=__codelineno-0-272 name=__codelineno-0-272 href=#__codelineno-0-272></a>            <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>status_emoji</span><span class=si>}</span><span class=s2> [</span><span class=si>{</span><span class=n>pulse</span><span class=o>.</span><span class=n>id</span><span class=si>:</span><span class=s2>04d</span><span class=si>}</span><span class=s2>] </span><span class=si>{</span><span class=n>emoji</span><span class=si>}</span><span class=s2> </span><span class=si>{</span><span class=n>time_str</span><span class=si>:</span><span class=s2>12s</span><span class=si>}</span><span class=s2> | </span><span class=si>{</span><span class=n>prompt_preview</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-273 name=__codelineno-0-273 href=#__codelineno-0-273></a>        <span class=p>)</span>
<a id=__codelineno-0-274 name=__codelineno-0-274 href=#__codelineno-0-274></a>
<a id=__codelineno-0-275 name=__codelineno-0-275 href=#__codelineno-0-275></a>    <span class=k>return</span> <span class=s2>&quot;</span><span class=se>\n</span><span class=s2>&quot;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>lines</span><span class=p>)</span>
<a id=__codelineno-0-276 name=__codelineno-0-276 href=#__codelineno-0-276></a>
<a id=__codelineno-0-277 name=__codelineno-0-277 href=#__codelineno-0-277></a>
<a id=__codelineno-0-278 name=__codelineno-0-278 href=#__codelineno-0-278></a><span class=nd>@app</span><span class=o>.</span><span class=n>tool</span><span class=p>()</span>
<a id=__codelineno-0-279 name=__codelineno-0-279 href=#__codelineno-0-279></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>cancel_pulse</span><span class=p>(</span>
<a id=__codelineno-0-280 name=__codelineno-0-280 href=#__codelineno-0-280></a>    <span class=n>pulse_id</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-281 name=__codelineno-0-281 href=#__codelineno-0-281></a>        <span class=nb>int</span><span class=p>,</span>
<a id=__codelineno-0-282 name=__codelineno-0-282 href=#__codelineno-0-282></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-283 name=__codelineno-0-283 href=#__codelineno-0-283></a>            <span class=n>description</span><span class=o>=</span><span class=s2>&quot;The ID of the pulse to cancel (from list_upcoming_pulses)&quot;</span><span class=p>,</span>
<a id=__codelineno-0-284 name=__codelineno-0-284 href=#__codelineno-0-284></a>            <span class=n>gt</span><span class=o>=</span><span class=mi>0</span>
<a id=__codelineno-0-285 name=__codelineno-0-285 href=#__codelineno-0-285></a>        <span class=p>)</span>
<a id=__codelineno-0-286 name=__codelineno-0-286 href=#__codelineno-0-286></a>    <span class=p>],</span>
<a id=__codelineno-0-287 name=__codelineno-0-287 href=#__codelineno-0-287></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-0-288 name=__codelineno-0-288 href=#__codelineno-0-288></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-0-289 name=__codelineno-0-289 href=#__codelineno-0-289></a><span class=sd>    Cancel a scheduled pulse.</span>
<a id=__codelineno-0-290 name=__codelineno-0-290 href=#__codelineno-0-290></a>
<a id=__codelineno-0-291 name=__codelineno-0-291 href=#__codelineno-0-291></a><span class=sd>    Use this when a task is no longer needed or circumstances have changed.</span>
<a id=__codelineno-0-292 name=__codelineno-0-292 href=#__codelineno-0-292></a>
<a id=__codelineno-0-293 name=__codelineno-0-293 href=#__codelineno-0-293></a><span class=sd>    Examples:</span>
<a id=__codelineno-0-294 name=__codelineno-0-294 href=#__codelineno-0-294></a><span class=sd>        # User already handled the task manually</span>
<a id=__codelineno-0-295 name=__codelineno-0-295 href=#__codelineno-0-295></a><span class=sd>        cancel_pulse(pulse_id=42)</span>
<a id=__codelineno-0-296 name=__codelineno-0-296 href=#__codelineno-0-296></a>
<a id=__codelineno-0-297 name=__codelineno-0-297 href=#__codelineno-0-297></a><span class=sd>        # Event was cancelled</span>
<a id=__codelineno-0-298 name=__codelineno-0-298 href=#__codelineno-0-298></a><span class=sd>        cancel_pulse(pulse_id=123)</span>
<a id=__codelineno-0-299 name=__codelineno-0-299 href=#__codelineno-0-299></a>
<a id=__codelineno-0-300 name=__codelineno-0-300 href=#__codelineno-0-300></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-301 name=__codelineno-0-301 href=#__codelineno-0-301></a><span class=sd>        Confirmation message or error if pulse couldn&#39;t be cancelled</span>
<a id=__codelineno-0-302 name=__codelineno-0-302 href=#__codelineno-0-302></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-303 name=__codelineno-0-303 href=#__codelineno-0-303></a>    <span class=n>success</span> <span class=o>=</span> <span class=k>await</span> <span class=n>queue</span><span class=o>.</span><span class=n>cancel_pulse</span><span class=p>(</span><span class=n>pulse_id</span><span class=p>)</span>
<a id=__codelineno-0-304 name=__codelineno-0-304 href=#__codelineno-0-304></a>
<a id=__codelineno-0-305 name=__codelineno-0-305 href=#__codelineno-0-305></a>    <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
<a id=__codelineno-0-306 name=__codelineno-0-306 href=#__codelineno-0-306></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;‚úì Pulse </span><span class=si>{</span><span class=n>pulse_id</span><span class=si>}</span><span class=s2> cancelled successfully&quot;</span>
<a id=__codelineno-0-307 name=__codelineno-0-307 href=#__codelineno-0-307></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-308 name=__codelineno-0-308 href=#__codelineno-0-308></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;‚úó Could not cancel pulse </span><span class=si>{</span><span class=n>pulse_id</span><span class=si>}</span><span class=s2> (may be already completed or not found)&quot;</span>
<a id=__codelineno-0-309 name=__codelineno-0-309 href=#__codelineno-0-309></a>
<a id=__codelineno-0-310 name=__codelineno-0-310 href=#__codelineno-0-310></a>
<a id=__codelineno-0-311 name=__codelineno-0-311 href=#__codelineno-0-311></a><span class=nd>@app</span><span class=o>.</span><span class=n>tool</span><span class=p>()</span>
<a id=__codelineno-0-312 name=__codelineno-0-312 href=#__codelineno-0-312></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>reschedule_pulse</span><span class=p>(</span>
<a id=__codelineno-0-313 name=__codelineno-0-313 href=#__codelineno-0-313></a>    <span class=n>pulse_id</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-314 name=__codelineno-0-314 href=#__codelineno-0-314></a>        <span class=nb>int</span><span class=p>,</span>
<a id=__codelineno-0-315 name=__codelineno-0-315 href=#__codelineno-0-315></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-316 name=__codelineno-0-316 href=#__codelineno-0-316></a>            <span class=n>description</span><span class=o>=</span><span class=s2>&quot;The ID of the pulse to reschedule (from list_upcoming_pulses)&quot;</span><span class=p>,</span>
<a id=__codelineno-0-317 name=__codelineno-0-317 href=#__codelineno-0-317></a>            <span class=n>gt</span><span class=o>=</span><span class=mi>0</span>
<a id=__codelineno-0-318 name=__codelineno-0-318 href=#__codelineno-0-318></a>        <span class=p>)</span>
<a id=__codelineno-0-319 name=__codelineno-0-319 href=#__codelineno-0-319></a>    <span class=p>],</span>
<a id=__codelineno-0-320 name=__codelineno-0-320 href=#__codelineno-0-320></a>    <span class=n>new_scheduled_at</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-0-321 name=__codelineno-0-321 href=#__codelineno-0-321></a>        <span class=nb>str</span><span class=p>,</span>
<a id=__codelineno-0-322 name=__codelineno-0-322 href=#__codelineno-0-322></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-0-323 name=__codelineno-0-323 href=#__codelineno-0-323></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-0-324 name=__codelineno-0-324 href=#__codelineno-0-324></a>                <span class=s2>&quot;New execution time. Accepts same formats as schedule_pulse:</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-325 name=__codelineno-0-325 href=#__codelineno-0-325></a>                <span class=s2>&quot;- ISO 8601: &#39;2026-01-20T09:00:00Z&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-326 name=__codelineno-0-326 href=#__codelineno-0-326></a>                <span class=s2>&quot;- Relative: &#39;in 2 hours&#39;, &#39;tomorrow at 9am&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-0-327 name=__codelineno-0-327 href=#__codelineno-0-327></a>                <span class=s2>&quot;- Keywords: &#39;tonight&#39;, &#39;tomorrow morning&#39;&quot;</span>
<a id=__codelineno-0-328 name=__codelineno-0-328 href=#__codelineno-0-328></a>            <span class=p>),</span>
<a id=__codelineno-0-329 name=__codelineno-0-329 href=#__codelineno-0-329></a>            <span class=n>examples</span><span class=o>=</span><span class=p>[</span><span class=s2>&quot;in 2 hours&quot;</span><span class=p>,</span> <span class=s2>&quot;tomorrow at 9am&quot;</span><span class=p>,</span> <span class=s2>&quot;2026-01-20T15:00:00Z&quot;</span><span class=p>]</span>
<a id=__codelineno-0-330 name=__codelineno-0-330 href=#__codelineno-0-330></a>        <span class=p>)</span>
<a id=__codelineno-0-331 name=__codelineno-0-331 href=#__codelineno-0-331></a>    <span class=p>],</span>
<a id=__codelineno-0-332 name=__codelineno-0-332 href=#__codelineno-0-332></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-0-333 name=__codelineno-0-333 href=#__codelineno-0-333></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-0-334 name=__codelineno-0-334 href=#__codelineno-0-334></a><span class=sd>    Reschedule a pulse to a different time.</span>
<a id=__codelineno-0-335 name=__codelineno-0-335 href=#__codelineno-0-335></a>
<a id=__codelineno-0-336 name=__codelineno-0-336 href=#__codelineno-0-336></a><span class=sd>    Use this when timing needs to change but the task itself remains relevant.</span>
<a id=__codelineno-0-337 name=__codelineno-0-337 href=#__codelineno-0-337></a>
<a id=__codelineno-0-338 name=__codelineno-0-338 href=#__codelineno-0-338></a><span class=sd>    Examples:</span>
<a id=__codelineno-0-339 name=__codelineno-0-339 href=#__codelineno-0-339></a><span class=sd>        # Postpone to tomorrow</span>
<a id=__codelineno-0-340 name=__codelineno-0-340 href=#__codelineno-0-340></a><span class=sd>        reschedule_pulse(pulse_id=42, new_scheduled_at=&quot;tomorrow at 9am&quot;)</span>
<a id=__codelineno-0-341 name=__codelineno-0-341 href=#__codelineno-0-341></a>
<a id=__codelineno-0-342 name=__codelineno-0-342 href=#__codelineno-0-342></a><span class=sd>        # Move earlier</span>
<a id=__codelineno-0-343 name=__codelineno-0-343 href=#__codelineno-0-343></a><span class=sd>        reschedule_pulse(pulse_id=123, new_scheduled_at=&quot;in 30 minutes&quot;)</span>
<a id=__codelineno-0-344 name=__codelineno-0-344 href=#__codelineno-0-344></a>
<a id=__codelineno-0-345 name=__codelineno-0-345 href=#__codelineno-0-345></a><span class=sd>    Returns:</span>
<a id=__codelineno-0-346 name=__codelineno-0-346 href=#__codelineno-0-346></a><span class=sd>        Confirmation message with old and new times</span>
<a id=__codelineno-0-347 name=__codelineno-0-347 href=#__codelineno-0-347></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-348 name=__codelineno-0-348 href=#__codelineno-0-348></a>    <span class=n>parsed_time</span> <span class=o>=</span> <span class=n>_parse_time_string</span><span class=p>(</span><span class=n>new_scheduled_at</span><span class=p>)</span>
<a id=__codelineno-0-349 name=__codelineno-0-349 href=#__codelineno-0-349></a>    <span class=n>success</span> <span class=o>=</span> <span class=k>await</span> <span class=n>queue</span><span class=o>.</span><span class=n>reschedule_pulse</span><span class=p>(</span><span class=n>pulse_id</span><span class=p>,</span> <span class=n>parsed_time</span><span class=p>)</span>
<a id=__codelineno-0-350 name=__codelineno-0-350 href=#__codelineno-0-350></a>
<a id=__codelineno-0-351 name=__codelineno-0-351 href=#__codelineno-0-351></a>    <span class=k>if</span> <span class=n>success</span><span class=p>:</span>
<a id=__codelineno-0-352 name=__codelineno-0-352 href=#__codelineno-0-352></a>        <span class=n>time_str</span> <span class=o>=</span> <span class=n>parsed_time</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s2>&quot;%Y-%m-</span><span class=si>%d</span><span class=s2> %H:%M:%S %Z&quot;</span><span class=p>)</span>
<a id=__codelineno-0-353 name=__codelineno-0-353 href=#__codelineno-0-353></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;‚úì Pulse </span><span class=si>{</span><span class=n>pulse_id</span><span class=si>}</span><span class=s2> rescheduled to </span><span class=si>{</span><span class=n>time_str</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-0-354 name=__codelineno-0-354 href=#__codelineno-0-354></a>    <span class=k>else</span><span class=p>:</span>
<a id=__codelineno-0-355 name=__codelineno-0-355 href=#__codelineno-0-355></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;‚úó Could not reschedule pulse </span><span class=si>{</span><span class=n>pulse_id</span><span class=si>}</span><span class=s2> (may be already completed or not found)&quot;</span>
<a id=__codelineno-0-356 name=__codelineno-0-356 href=#__codelineno-0-356></a>
<a id=__codelineno-0-357 name=__codelineno-0-357 href=#__codelineno-0-357></a>
<a id=__codelineno-0-358 name=__codelineno-0-358 href=#__codelineno-0-358></a><span class=c1># ============================================================================</span>
<a id=__codelineno-0-359 name=__codelineno-0-359 href=#__codelineno-0-359></a><span class=c1># Helper Functions</span>
<a id=__codelineno-0-360 name=__codelineno-0-360 href=#__codelineno-0-360></a><span class=c1># ============================================================================</span>
<a id=__codelineno-0-361 name=__codelineno-0-361 href=#__codelineno-0-361></a>
<a id=__codelineno-0-362 name=__codelineno-0-362 href=#__codelineno-0-362></a><span class=k>def</span><span class=w> </span><span class=nf>_parse_time_string</span><span class=p>(</span><span class=n>time_str</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>datetime</span><span class=p>:</span>
<a id=__codelineno-0-363 name=__codelineno-0-363 href=#__codelineno-0-363></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-0-364 name=__codelineno-0-364 href=#__codelineno-0-364></a><span class=sd>    Parse a flexible time string into a UTC datetime.</span>
<a id=__codelineno-0-365 name=__codelineno-0-365 href=#__codelineno-0-365></a>
<a id=__codelineno-0-366 name=__codelineno-0-366 href=#__codelineno-0-366></a><span class=sd>    Supports:</span>
<a id=__codelineno-0-367 name=__codelineno-0-367 href=#__codelineno-0-367></a><span class=sd>    - ISO 8601: &quot;2026-01-20T09:00:00Z&quot;</span>
<a id=__codelineno-0-368 name=__codelineno-0-368 href=#__codelineno-0-368></a><span class=sd>    - Relative: &quot;in 2 hours&quot;, &quot;in 30 minutes&quot;</span>
<a id=__codelineno-0-369 name=__codelineno-0-369 href=#__codelineno-0-369></a><span class=sd>    - Keywords: &quot;now&quot;, &quot;tonight&quot;, &quot;tomorrow morning&quot;</span>
<a id=__codelineno-0-370 name=__codelineno-0-370 href=#__codelineno-0-370></a>
<a id=__codelineno-0-371 name=__codelineno-0-371 href=#__codelineno-0-371></a><span class=sd>    TODO: Integrate with a proper NLP library (dateparser, parsedatetime)</span>
<a id=__codelineno-0-372 name=__codelineno-0-372 href=#__codelineno-0-372></a><span class=sd>    For now, implement basic cases.</span>
<a id=__codelineno-0-373 name=__codelineno-0-373 href=#__codelineno-0-373></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-0-374 name=__codelineno-0-374 href=#__codelineno-0-374></a>    <span class=n>time_str</span> <span class=o>=</span> <span class=n>time_str</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span><span class=o>.</span><span class=n>lower</span><span class=p>()</span>
<a id=__codelineno-0-375 name=__codelineno-0-375 href=#__codelineno-0-375></a>
<a id=__codelineno-0-376 name=__codelineno-0-376 href=#__codelineno-0-376></a>    <span class=c1># Keyword: &quot;now&quot;</span>
<a id=__codelineno-0-377 name=__codelineno-0-377 href=#__codelineno-0-377></a>    <span class=k>if</span> <span class=n>time_str</span> <span class=o>==</span> <span class=s2>&quot;now&quot;</span><span class=p>:</span>
<a id=__codelineno-0-378 name=__codelineno-0-378 href=#__codelineno-0-378></a>        <span class=k>return</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>timezone</span><span class=o>.</span><span class=n>utc</span><span class=p>)</span>
<a id=__codelineno-0-379 name=__codelineno-0-379 href=#__codelineno-0-379></a>
<a id=__codelineno-0-380 name=__codelineno-0-380 href=#__codelineno-0-380></a>    <span class=c1># ISO 8601</span>
<a id=__codelineno-0-381 name=__codelineno-0-381 href=#__codelineno-0-381></a>    <span class=k>if</span> <span class=s2>&quot;T&quot;</span> <span class=ow>in</span> <span class=n>time_str</span> <span class=ow>or</span> <span class=n>time_str</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s2>&quot;Z&quot;</span><span class=p>):</span>
<a id=__codelineno-0-382 name=__codelineno-0-382 href=#__codelineno-0-382></a>        <span class=k>return</span> <span class=n>datetime</span><span class=o>.</span><span class=n>fromisoformat</span><span class=p>(</span><span class=n>time_str</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=s2>&quot;Z&quot;</span><span class=p>,</span> <span class=s2>&quot;+00:00&quot;</span><span class=p>))</span>
<a id=__codelineno-0-383 name=__codelineno-0-383 href=#__codelineno-0-383></a>
<a id=__codelineno-0-384 name=__codelineno-0-384 href=#__codelineno-0-384></a>    <span class=c1># Relative: &quot;in X hours/minutes&quot;</span>
<a id=__codelineno-0-385 name=__codelineno-0-385 href=#__codelineno-0-385></a>    <span class=k>if</span> <span class=n>time_str</span><span class=o>.</span><span class=n>startswith</span><span class=p>(</span><span class=s2>&quot;in &quot;</span><span class=p>):</span>
<a id=__codelineno-0-386 name=__codelineno-0-386 href=#__codelineno-0-386></a>        <span class=n>parts</span> <span class=o>=</span> <span class=n>time_str</span><span class=p>[</span><span class=mi>3</span><span class=p>:]</span><span class=o>.</span><span class=n>split</span><span class=p>()</span>
<a id=__codelineno-0-387 name=__codelineno-0-387 href=#__codelineno-0-387></a>        <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>parts</span><span class=p>)</span> <span class=o>==</span> <span class=mi>2</span><span class=p>:</span>
<a id=__codelineno-0-388 name=__codelineno-0-388 href=#__codelineno-0-388></a>            <span class=n>amount</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>parts</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
<a id=__codelineno-0-389 name=__codelineno-0-389 href=#__codelineno-0-389></a>            <span class=n>unit</span> <span class=o>=</span> <span class=n>parts</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s2>&quot;s&quot;</span><span class=p>)</span>  <span class=c1># &quot;hours&quot; -&gt; &quot;hour&quot;</span>
<a id=__codelineno-0-390 name=__codelineno-0-390 href=#__codelineno-0-390></a>
<a id=__codelineno-0-391 name=__codelineno-0-391 href=#__codelineno-0-391></a>            <span class=k>if</span> <span class=n>unit</span> <span class=o>==</span> <span class=s2>&quot;minute&quot;</span><span class=p>:</span>
<a id=__codelineno-0-392 name=__codelineno-0-392 href=#__codelineno-0-392></a>                <span class=k>return</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>timezone</span><span class=o>.</span><span class=n>utc</span><span class=p>)</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>minutes</span><span class=o>=</span><span class=n>amount</span><span class=p>)</span>
<a id=__codelineno-0-393 name=__codelineno-0-393 href=#__codelineno-0-393></a>            <span class=k>elif</span> <span class=n>unit</span> <span class=o>==</span> <span class=s2>&quot;hour&quot;</span><span class=p>:</span>
<a id=__codelineno-0-394 name=__codelineno-0-394 href=#__codelineno-0-394></a>                <span class=k>return</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>timezone</span><span class=o>.</span><span class=n>utc</span><span class=p>)</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>hours</span><span class=o>=</span><span class=n>amount</span><span class=p>)</span>
<a id=__codelineno-0-395 name=__codelineno-0-395 href=#__codelineno-0-395></a>            <span class=k>elif</span> <span class=n>unit</span> <span class=o>==</span> <span class=s2>&quot;day&quot;</span><span class=p>:</span>
<a id=__codelineno-0-396 name=__codelineno-0-396 href=#__codelineno-0-396></a>                <span class=k>return</span> <span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>(</span><span class=n>timezone</span><span class=o>.</span><span class=n>utc</span><span class=p>)</span> <span class=o>+</span> <span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=n>amount</span><span class=p>)</span>
<a id=__codelineno-0-397 name=__codelineno-0-397 href=#__codelineno-0-397></a>
<a id=__codelineno-0-398 name=__codelineno-0-398 href=#__codelineno-0-398></a>    <span class=c1># Fallback: raise error for unimplemented formats</span>
<a id=__codelineno-0-399 name=__codelineno-0-399 href=#__codelineno-0-399></a>    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span>
<a id=__codelineno-0-400 name=__codelineno-0-400 href=#__codelineno-0-400></a>        <span class=sa>f</span><span class=s2>&quot;Could not parse time string: &#39;</span><span class=si>{</span><span class=n>time_str</span><span class=si>}</span><span class=s2>&#39;. &quot;</span>
<a id=__codelineno-0-401 name=__codelineno-0-401 href=#__codelineno-0-401></a>        <span class=sa>f</span><span class=s2>&quot;Supported formats: ISO 8601, &#39;now&#39;, &#39;in X hours/minutes/days&#39;&quot;</span>
<a id=__codelineno-0-402 name=__codelineno-0-402 href=#__codelineno-0-402></a>    <span class=p>)</span>
<a id=__codelineno-0-403 name=__codelineno-0-403 href=#__codelineno-0-403></a>
<a id=__codelineno-0-404 name=__codelineno-0-404 href=#__codelineno-0-404></a>
<a id=__codelineno-0-405 name=__codelineno-0-405 href=#__codelineno-0-405></a><span class=k>def</span><span class=w> </span><span class=nf>_priority_emoji</span><span class=p>(</span><span class=n>priority</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-0-406 name=__codelineno-0-406 href=#__codelineno-0-406></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map priority to emoji for visual scanning.&quot;&quot;&quot;</span>
<a id=__codelineno-0-407 name=__codelineno-0-407 href=#__codelineno-0-407></a>    <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-0-408 name=__codelineno-0-408 href=#__codelineno-0-408></a>        <span class=s2>&quot;critical&quot;</span><span class=p>:</span> <span class=s2>&quot;üö®&quot;</span><span class=p>,</span>
<a id=__codelineno-0-409 name=__codelineno-0-409 href=#__codelineno-0-409></a>        <span class=s2>&quot;high&quot;</span><span class=p>:</span> <span class=s2>&quot;üîî&quot;</span><span class=p>,</span>
<a id=__codelineno-0-410 name=__codelineno-0-410 href=#__codelineno-0-410></a>        <span class=s2>&quot;normal&quot;</span><span class=p>:</span> <span class=s2>&quot;‚è∞&quot;</span><span class=p>,</span>
<a id=__codelineno-0-411 name=__codelineno-0-411 href=#__codelineno-0-411></a>        <span class=s2>&quot;low&quot;</span><span class=p>:</span> <span class=s2>&quot;üìã&quot;</span><span class=p>,</span>
<a id=__codelineno-0-412 name=__codelineno-0-412 href=#__codelineno-0-412></a>        <span class=s2>&quot;deferred&quot;</span><span class=p>:</span> <span class=s2>&quot;üïê&quot;</span><span class=p>,</span>
<a id=__codelineno-0-413 name=__codelineno-0-413 href=#__codelineno-0-413></a>    <span class=p>}</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>priority</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
<a id=__codelineno-0-414 name=__codelineno-0-414 href=#__codelineno-0-414></a>
<a id=__codelineno-0-415 name=__codelineno-0-415 href=#__codelineno-0-415></a>
<a id=__codelineno-0-416 name=__codelineno-0-416 href=#__codelineno-0-416></a><span class=k>def</span><span class=w> </span><span class=nf>_status_emoji</span><span class=p>(</span><span class=n>status</span><span class=p>:</span> <span class=nb>str</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-0-417 name=__codelineno-0-417 href=#__codelineno-0-417></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Map status to emoji for visual scanning.&quot;&quot;&quot;</span>
<a id=__codelineno-0-418 name=__codelineno-0-418 href=#__codelineno-0-418></a>    <span class=k>return</span> <span class=p>{</span>
<a id=__codelineno-0-419 name=__codelineno-0-419 href=#__codelineno-0-419></a>        <span class=s2>&quot;pending&quot;</span><span class=p>:</span> <span class=s2>&quot;‚è≥&quot;</span><span class=p>,</span>
<a id=__codelineno-0-420 name=__codelineno-0-420 href=#__codelineno-0-420></a>        <span class=s2>&quot;processing&quot;</span><span class=p>:</span> <span class=s2>&quot;‚öôÔ∏è&quot;</span><span class=p>,</span>
<a id=__codelineno-0-421 name=__codelineno-0-421 href=#__codelineno-0-421></a>        <span class=s2>&quot;completed&quot;</span><span class=p>:</span> <span class=s2>&quot;‚úÖ&quot;</span><span class=p>,</span>
<a id=__codelineno-0-422 name=__codelineno-0-422 href=#__codelineno-0-422></a>        <span class=s2>&quot;failed&quot;</span><span class=p>:</span> <span class=s2>&quot;‚ùå&quot;</span><span class=p>,</span>
<a id=__codelineno-0-423 name=__codelineno-0-423 href=#__codelineno-0-423></a>        <span class=s2>&quot;cancelled&quot;</span><span class=p>:</span> <span class=s2>&quot;üö´&quot;</span><span class=p>,</span>
<a id=__codelineno-0-424 name=__codelineno-0-424 href=#__codelineno-0-424></a>    <span class=p>}</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>status</span><span class=p>,</span> <span class=s2>&quot;&quot;</span><span class=p>)</span>
<a id=__codelineno-0-425 name=__codelineno-0-425 href=#__codelineno-0-425></a>
<a id=__codelineno-0-426 name=__codelineno-0-426 href=#__codelineno-0-426></a>
<a id=__codelineno-0-427 name=__codelineno-0-427 href=#__codelineno-0-427></a><span class=c1># ============================================================================</span>
<a id=__codelineno-0-428 name=__codelineno-0-428 href=#__codelineno-0-428></a><span class=c1># Server Entry Point</span>
<a id=__codelineno-0-429 name=__codelineno-0-429 href=#__codelineno-0-429></a><span class=c1># ============================================================================</span>
<a id=__codelineno-0-430 name=__codelineno-0-430 href=#__codelineno-0-430></a>
<a id=__codelineno-0-431 name=__codelineno-0-431 href=#__codelineno-0-431></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>main</span><span class=p>():</span>
<a id=__codelineno-0-432 name=__codelineno-0-432 href=#__codelineno-0-432></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;Run the MCP server on stdio.&quot;&quot;&quot;</span>
<a id=__codelineno-0-433 name=__codelineno-0-433 href=#__codelineno-0-433></a>    <span class=k>async</span> <span class=k>with</span> <span class=n>stdio_server</span><span class=p>()</span> <span class=k>as</span> <span class=p>(</span><span class=n>read_stream</span><span class=p>,</span> <span class=n>write_stream</span><span class=p>):</span>
<a id=__codelineno-0-434 name=__codelineno-0-434 href=#__codelineno-0-434></a>        <span class=k>await</span> <span class=n>app</span><span class=o>.</span><span class=n>run</span><span class=p>(</span>
<a id=__codelineno-0-435 name=__codelineno-0-435 href=#__codelineno-0-435></a>            <span class=n>read_stream</span><span class=p>,</span>
<a id=__codelineno-0-436 name=__codelineno-0-436 href=#__codelineno-0-436></a>            <span class=n>write_stream</span><span class=p>,</span>
<a id=__codelineno-0-437 name=__codelineno-0-437 href=#__codelineno-0-437></a>            <span class=n>app</span><span class=o>.</span><span class=n>create_initialization_options</span><span class=p>()</span>
<a id=__codelineno-0-438 name=__codelineno-0-438 href=#__codelineno-0-438></a>        <span class=p>)</span>
<a id=__codelineno-0-439 name=__codelineno-0-439 href=#__codelineno-0-439></a>
<a id=__codelineno-0-440 name=__codelineno-0-440 href=#__codelineno-0-440></a>
<a id=__codelineno-0-441 name=__codelineno-0-441 href=#__codelineno-0-441></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
<a id=__codelineno-0-442 name=__codelineno-0-442 href=#__codelineno-0-442></a>    <span class=kn>import</span><span class=w> </span><span class=nn>asyncio</span>
<a id=__codelineno-0-443 name=__codelineno-0-443 href=#__codelineno-0-443></a>    <span class=n>asyncio</span><span class=o>.</span><span class=n>run</span><span class=p>(</span><span class=n>main</span><span class=p>())</span>
</code></pre></div> <hr> <h2 id=mcp-server-2-telegram-notification-server>MCP Server 2: Telegram Notification Server<a class=headerlink href=#mcp-server-2-telegram-notification-server title="Permanent link">&para;</a></h2> <p><strong>Module</strong>: <code>src/reeve/mcp/notification_server.py</code></p> <p><strong>Purpose</strong>: Allow Reeve to send push notifications to the user via Telegram.</p> <p><strong>Connection Type</strong>: stdio (spawned on-demand by Reeve)</p> <h3 id=implementation_1>Implementation<a class=headerlink href=#implementation_1 title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=sd>MCP Server for Telegram Notifications</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=sd>This server exposes tools that allow Reeve to send push notifications to the</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=sd>user via Telegram. This is Reeve&#39;s &quot;voice&quot; - how it communicates proactively.</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=sd>Environment Variables:</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=sd>    TELEGRAM_BOT_TOKEN: Telegram bot token (required)</span>
<a id=__codelineno-1-9 name=__codelineno-1-9 href=#__codelineno-1-9></a><span class=sd>    TELEGRAM_CHAT_ID: User&#39;s Telegram chat ID (required)</span>
<a id=__codelineno-1-10 name=__codelineno-1-10 href=#__codelineno-1-10></a><span class=sd>    HAPI_BASE_URL: Base URL for Hapi sessions (optional, defaults to https://hapi.run)</span>
<a id=__codelineno-1-11 name=__codelineno-1-11 href=#__codelineno-1-11></a>
<a id=__codelineno-1-12 name=__codelineno-1-12 href=#__codelineno-1-12></a><span class=sd>Usage:</span>
<a id=__codelineno-1-13 name=__codelineno-1-13 href=#__codelineno-1-13></a><span class=sd>    Configure in ~/.config/claude-code/mcp_config.json:</span>
<a id=__codelineno-1-14 name=__codelineno-1-14 href=#__codelineno-1-14></a><span class=sd>    {</span>
<a id=__codelineno-1-15 name=__codelineno-1-15 href=#__codelineno-1-15></a><span class=sd>      &quot;mcpServers&quot;: {</span>
<a id=__codelineno-1-16 name=__codelineno-1-16 href=#__codelineno-1-16></a><span class=sd>        &quot;telegram-notifier&quot;: {</span>
<a id=__codelineno-1-17 name=__codelineno-1-17 href=#__codelineno-1-17></a><span class=sd>          &quot;command&quot;: &quot;uv&quot;,</span>
<a id=__codelineno-1-18 name=__codelineno-1-18 href=#__codelineno-1-18></a><span class=sd>          &quot;args&quot;: [&quot;run&quot;, &quot;--directory&quot;, &quot;/path/to/reeve-bot&quot;, &quot;python&quot;, &quot;-m&quot;, &quot;reeve.mcp.notification_server&quot;],</span>
<a id=__codelineno-1-19 name=__codelineno-1-19 href=#__codelineno-1-19></a><span class=sd>          &quot;env&quot;: {</span>
<a id=__codelineno-1-20 name=__codelineno-1-20 href=#__codelineno-1-20></a><span class=sd>            &quot;TELEGRAM_BOT_TOKEN&quot;: &quot;your_bot_token&quot;,</span>
<a id=__codelineno-1-21 name=__codelineno-1-21 href=#__codelineno-1-21></a><span class=sd>            &quot;TELEGRAM_CHAT_ID&quot;: &quot;your_chat_id&quot;,</span>
<a id=__codelineno-1-22 name=__codelineno-1-22 href=#__codelineno-1-22></a><span class=sd>            &quot;HAPI_BASE_URL&quot;: &quot;https://hapi.run&quot;</span>
<a id=__codelineno-1-23 name=__codelineno-1-23 href=#__codelineno-1-23></a><span class=sd>          }</span>
<a id=__codelineno-1-24 name=__codelineno-1-24 href=#__codelineno-1-24></a><span class=sd>        }</span>
<a id=__codelineno-1-25 name=__codelineno-1-25 href=#__codelineno-1-25></a><span class=sd>      }</span>
<a id=__codelineno-1-26 name=__codelineno-1-26 href=#__codelineno-1-26></a><span class=sd>    }</span>
<a id=__codelineno-1-27 name=__codelineno-1-27 href=#__codelineno-1-27></a><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-1-28 name=__codelineno-1-28 href=#__codelineno-1-28></a>
<a id=__codelineno-1-29 name=__codelineno-1-29 href=#__codelineno-1-29></a><span class=kn>import</span><span class=w> </span><span class=nn>os</span>
<a id=__codelineno-1-30 name=__codelineno-1-30 href=#__codelineno-1-30></a><span class=kn>from</span><span class=w> </span><span class=nn>typing</span><span class=w> </span><span class=kn>import</span> <span class=n>Annotated</span><span class=p>,</span> <span class=n>Literal</span>
<a id=__codelineno-1-31 name=__codelineno-1-31 href=#__codelineno-1-31></a>
<a id=__codelineno-1-32 name=__codelineno-1-32 href=#__codelineno-1-32></a><span class=kn>import</span><span class=w> </span><span class=nn>requests</span>
<a id=__codelineno-1-33 name=__codelineno-1-33 href=#__codelineno-1-33></a><span class=kn>from</span><span class=w> </span><span class=nn>mcp.server.fastmcp</span><span class=w> </span><span class=kn>import</span> <span class=n>FastMCP</span><span class=p>,</span> <span class=n>Context</span>
<a id=__codelineno-1-34 name=__codelineno-1-34 href=#__codelineno-1-34></a><span class=kn>from</span><span class=w> </span><span class=nn>pydantic</span><span class=w> </span><span class=kn>import</span> <span class=n>Field</span>
<a id=__codelineno-1-35 name=__codelineno-1-35 href=#__codelineno-1-35></a>
<a id=__codelineno-1-36 name=__codelineno-1-36 href=#__codelineno-1-36></a><span class=c1># Initialize the MCP server</span>
<a id=__codelineno-1-37 name=__codelineno-1-37 href=#__codelineno-1-37></a><span class=n>mcp</span> <span class=o>=</span> <span class=n>FastMCP</span><span class=p>(</span><span class=s2>&quot;telegram-notifier&quot;</span><span class=p>)</span>
<a id=__codelineno-1-38 name=__codelineno-1-38 href=#__codelineno-1-38></a>
<a id=__codelineno-1-39 name=__codelineno-1-39 href=#__codelineno-1-39></a><span class=c1># Telegram Bot Configuration</span>
<a id=__codelineno-1-40 name=__codelineno-1-40 href=#__codelineno-1-40></a><span class=n>BOT_TOKEN</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;TELEGRAM_BOT_TOKEN&quot;</span><span class=p>)</span>
<a id=__codelineno-1-41 name=__codelineno-1-41 href=#__codelineno-1-41></a><span class=n>CHAT_ID</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;TELEGRAM_CHAT_ID&quot;</span><span class=p>)</span>  <span class=c1># The user&#39;s chat ID</span>
<a id=__codelineno-1-42 name=__codelineno-1-42 href=#__codelineno-1-42></a><span class=n>HAPI_BASE_URL</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>getenv</span><span class=p>(</span><span class=s2>&quot;HAPI_BASE_URL&quot;</span><span class=p>,</span> <span class=s2>&quot;https://hapi.run&quot;</span><span class=p>)</span>
<a id=__codelineno-1-43 name=__codelineno-1-43 href=#__codelineno-1-43></a>
<a id=__codelineno-1-44 name=__codelineno-1-44 href=#__codelineno-1-44></a><span class=k>if</span> <span class=ow>not</span> <span class=n>BOT_TOKEN</span> <span class=ow>or</span> <span class=ow>not</span> <span class=n>CHAT_ID</span><span class=p>:</span>
<a id=__codelineno-1-45 name=__codelineno-1-45 href=#__codelineno-1-45></a>    <span class=k>raise</span> <span class=ne>ValueError</span><span class=p>(</span><span class=s2>&quot;TELEGRAM_BOT_TOKEN and TELEGRAM_CHAT_ID environment variables are required&quot;</span><span class=p>)</span>
<a id=__codelineno-1-46 name=__codelineno-1-46 href=#__codelineno-1-46></a>
<a id=__codelineno-1-47 name=__codelineno-1-47 href=#__codelineno-1-47></a>
<a id=__codelineno-1-48 name=__codelineno-1-48 href=#__codelineno-1-48></a><span class=c1># ============================================================================</span>
<a id=__codelineno-1-49 name=__codelineno-1-49 href=#__codelineno-1-49></a><span class=c1># Tool Definitions</span>
<a id=__codelineno-1-50 name=__codelineno-1-50 href=#__codelineno-1-50></a><span class=c1># ============================================================================</span>
<a id=__codelineno-1-51 name=__codelineno-1-51 href=#__codelineno-1-51></a>
<a id=__codelineno-1-52 name=__codelineno-1-52 href=#__codelineno-1-52></a><span class=nd>@mcp</span><span class=o>.</span><span class=n>tool</span><span class=p>()</span>
<a id=__codelineno-1-53 name=__codelineno-1-53 href=#__codelineno-1-53></a><span class=k>async</span> <span class=k>def</span><span class=w> </span><span class=nf>send_notification</span><span class=p>(</span>
<a id=__codelineno-1-54 name=__codelineno-1-54 href=#__codelineno-1-54></a>    <span class=n>ctx</span><span class=p>:</span> <span class=n>Context</span><span class=p>,</span>
<a id=__codelineno-1-55 name=__codelineno-1-55 href=#__codelineno-1-55></a>    <span class=n>message</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-1-56 name=__codelineno-1-56 href=#__codelineno-1-56></a>        <span class=nb>str</span><span class=p>,</span>
<a id=__codelineno-1-57 name=__codelineno-1-57 href=#__codelineno-1-57></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-1-58 name=__codelineno-1-58 href=#__codelineno-1-58></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-1-59 name=__codelineno-1-59 href=#__codelineno-1-59></a>                <span class=s2>&quot;The notification message to send (up to 4096 characters). &quot;</span>
<a id=__codelineno-1-60 name=__codelineno-1-60 href=#__codelineno-1-60></a>                <span class=s2>&quot;Keep it concise and actionable - this is a push notification.</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-61 name=__codelineno-1-61 href=#__codelineno-1-61></a>                <span class=s2>&quot;Good examples:</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-62 name=__codelineno-1-62 href=#__codelineno-1-62></a>                <span class=s2>&quot;- &#39;üîî Powder Alert: 18 inches forecast for Mammoth this weekend&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-63 name=__codelineno-1-63 href=#__codelineno-1-63></a>                <span class=s2>&quot;- &#39;‚úì Daily briefing complete. 3 meetings today, 2 high-priority emails.&#39;</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-64 name=__codelineno-1-64 href=#__codelineno-1-64></a>                <span class=s2>&quot;- &#39;üö® Flight UA123 delayed 2 hours. New departure: 10:30 AM&#39;</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-65 name=__codelineno-1-65 href=#__codelineno-1-65></a>                <span class=s2>&quot;If parse_mode is set, you can use formatting:</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-66 name=__codelineno-1-66 href=#__codelineno-1-66></a>                <span class=s2>&quot;- MarkdownV2: *bold*, _italic_, `code`, [link](url)</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-67 name=__codelineno-1-67 href=#__codelineno-1-67></a>                <span class=s2>&quot;- HTML: &lt;b&gt;bold&lt;/b&gt;, &lt;i&gt;italic&lt;/i&gt;, &lt;code&gt;code&lt;/code&gt;, &lt;a href=&#39;url&#39;&gt;link&lt;/a&gt;&quot;</span>
<a id=__codelineno-1-68 name=__codelineno-1-68 href=#__codelineno-1-68></a>            <span class=p>),</span>
<a id=__codelineno-1-69 name=__codelineno-1-69 href=#__codelineno-1-69></a>            <span class=n>min_length</span><span class=o>=</span><span class=mi>1</span><span class=p>,</span>
<a id=__codelineno-1-70 name=__codelineno-1-70 href=#__codelineno-1-70></a>            <span class=n>max_length</span><span class=o>=</span><span class=mi>4096</span><span class=p>,</span>
<a id=__codelineno-1-71 name=__codelineno-1-71 href=#__codelineno-1-71></a>        <span class=p>),</span>
<a id=__codelineno-1-72 name=__codelineno-1-72 href=#__codelineno-1-72></a>    <span class=p>],</span>
<a id=__codelineno-1-73 name=__codelineno-1-73 href=#__codelineno-1-73></a>    <span class=n>priority</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-1-74 name=__codelineno-1-74 href=#__codelineno-1-74></a>        <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;silent&quot;</span><span class=p>,</span> <span class=s2>&quot;normal&quot;</span><span class=p>,</span> <span class=s2>&quot;critical&quot;</span><span class=p>],</span>
<a id=__codelineno-1-75 name=__codelineno-1-75 href=#__codelineno-1-75></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-1-76 name=__codelineno-1-76 href=#__codelineno-1-76></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-1-77 name=__codelineno-1-77 href=#__codelineno-1-77></a>                <span class=s2>&quot;Notification priority level:</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-78 name=__codelineno-1-78 href=#__codelineno-1-78></a>                <span class=s2>&quot;- &#39;silent&#39; (üîï): No alert, just logs to chat (no sound/vibration)</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-79 name=__codelineno-1-79 href=#__codelineno-1-79></a>                <span class=s2>&quot;- &#39;normal&#39; (üîî): Standard push notification with sound (default)</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-80 name=__codelineno-1-80 href=#__codelineno-1-80></a>                <span class=s2>&quot;- &#39;critical&#39; (üö®): High-priority alert with sound</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-81 name=__codelineno-1-81 href=#__codelineno-1-81></a>                <span class=s2>&quot;This controls both notification behavior and routing.&quot;</span>
<a id=__codelineno-1-82 name=__codelineno-1-82 href=#__codelineno-1-82></a>            <span class=p>),</span>
<a id=__codelineno-1-83 name=__codelineno-1-83 href=#__codelineno-1-83></a>        <span class=p>),</span>
<a id=__codelineno-1-84 name=__codelineno-1-84 href=#__codelineno-1-84></a>    <span class=p>]</span> <span class=o>=</span> <span class=s2>&quot;normal&quot;</span><span class=p>,</span>
<a id=__codelineno-1-85 name=__codelineno-1-85 href=#__codelineno-1-85></a>    <span class=n>parse_mode</span><span class=p>:</span> <span class=n>Annotated</span><span class=p>[</span>
<a id=__codelineno-1-86 name=__codelineno-1-86 href=#__codelineno-1-86></a>        <span class=n>Literal</span><span class=p>[</span><span class=s2>&quot;MarkdownV2&quot;</span><span class=p>,</span> <span class=s2>&quot;HTML&quot;</span><span class=p>,</span> <span class=s2>&quot;Markdown&quot;</span><span class=p>]</span> <span class=o>|</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-1-87 name=__codelineno-1-87 href=#__codelineno-1-87></a>        <span class=n>Field</span><span class=p>(</span>
<a id=__codelineno-1-88 name=__codelineno-1-88 href=#__codelineno-1-88></a>            <span class=n>description</span><span class=o>=</span><span class=p>(</span>
<a id=__codelineno-1-89 name=__codelineno-1-89 href=#__codelineno-1-89></a>                <span class=s2>&quot;Optional message formatting mode:</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-90 name=__codelineno-1-90 href=#__codelineno-1-90></a>                <span class=s2>&quot;- &#39;MarkdownV2&#39;: Markdown formatting (recommended) - *bold*, _italic_, `code`</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-91 name=__codelineno-1-91 href=#__codelineno-1-91></a>                <span class=s2>&quot;- &#39;HTML&#39;: HTML formatting - &lt;b&gt;bold&lt;/b&gt;, &lt;i&gt;italic&lt;/i&gt;, &lt;code&gt;code&lt;/code&gt;</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-92 name=__codelineno-1-92 href=#__codelineno-1-92></a>                <span class=s2>&quot;- &#39;Markdown&#39;: Legacy Markdown (deprecated, use MarkdownV2)</span><span class=se>\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-93 name=__codelineno-1-93 href=#__codelineno-1-93></a>                <span class=s2>&quot;- None: Plain text (default)</span><span class=se>\n\n</span><span class=s2>&quot;</span>
<a id=__codelineno-1-94 name=__codelineno-1-94 href=#__codelineno-1-94></a>                <span class=s2>&quot;Use MarkdownV2 for rich notifications, None for simple alerts.&quot;</span>
<a id=__codelineno-1-95 name=__codelineno-1-95 href=#__codelineno-1-95></a>            <span class=p>),</span>
<a id=__codelineno-1-96 name=__codelineno-1-96 href=#__codelineno-1-96></a>        <span class=p>),</span>
<a id=__codelineno-1-97 name=__codelineno-1-97 href=#__codelineno-1-97></a>    <span class=p>]</span> <span class=o>=</span> <span class=kc>None</span><span class=p>,</span>
<a id=__codelineno-1-98 name=__codelineno-1-98 href=#__codelineno-1-98></a><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>str</span><span class=p>:</span>
<a id=__codelineno-1-99 name=__codelineno-1-99 href=#__codelineno-1-99></a><span class=w>    </span><span class=sd>&quot;&quot;&quot;</span>
<a id=__codelineno-1-100 name=__codelineno-1-100 href=#__codelineno-1-100></a><span class=sd>    Send a push notification to the user via Telegram.</span>
<a id=__codelineno-1-101 name=__codelineno-1-101 href=#__codelineno-1-101></a>
<a id=__codelineno-1-102 name=__codelineno-1-102 href=#__codelineno-1-102></a><span class=sd>    This is Reeve&#39;s primary communication channel with the user. Use this to:</span>
<a id=__codelineno-1-103 name=__codelineno-1-103 href=#__codelineno-1-103></a><span class=sd>    - Alert about important events (flight delays, weather alerts, etc.)</span>
<a id=__codelineno-1-104 name=__codelineno-1-104 href=#__codelineno-1-104></a><span class=sd>    - Provide task completion updates</span>
<a id=__codelineno-1-105 name=__codelineno-1-105 href=#__codelineno-1-105></a><span class=sd>    - Request user input or decisions</span>
<a id=__codelineno-1-106 name=__codelineno-1-106 href=#__codelineno-1-106></a><span class=sd>    - Share summaries and insights</span>
<a id=__codelineno-1-107 name=__codelineno-1-107 href=#__codelineno-1-107></a>
<a id=__codelineno-1-108 name=__codelineno-1-108 href=#__codelineno-1-108></a><span class=sd>    The tool automatically includes a &quot;View in Claude Code&quot; button linking to the current</span>
<a id=__codelineno-1-109 name=__codelineno-1-109 href=#__codelineno-1-109></a><span class=sd>    session, so the user can quickly jump back to the conversation context.</span>
<a id=__codelineno-1-110 name=__codelineno-1-110 href=#__codelineno-1-110></a>
<a id=__codelineno-1-111 name=__codelineno-1-111 href=#__codelineno-1-111></a><span class=sd>    Priority levels control notification behavior:</span>
<a id=__codelineno-1-112 name=__codelineno-1-112 href=#__codelineno-1-112></a><span class=sd>    - silent: No sound/vibration (for background updates)</span>
<a id=__codelineno-1-113 name=__codelineno-1-113 href=#__codelineno-1-113></a><span class=sd>    - normal: Standard notification with sound (default)</span>
<a id=__codelineno-1-114 name=__codelineno-1-114 href=#__codelineno-1-114></a><span class=sd>    - critical: High-priority alert with sound</span>
<a id=__codelineno-1-115 name=__codelineno-1-115 href=#__codelineno-1-115></a>
<a id=__codelineno-1-116 name=__codelineno-1-116 href=#__codelineno-1-116></a><span class=sd>    When to use:</span>
<a id=__codelineno-1-117 name=__codelineno-1-117 href=#__codelineno-1-117></a><span class=sd>    - Proactive alerts: &quot;Something happened you should know about&quot;</span>
<a id=__codelineno-1-118 name=__codelineno-1-118 href=#__codelineno-1-118></a><span class=sd>    - Task updates: &quot;I finished X, here&#39;s the result&quot;</span>
<a id=__codelineno-1-119 name=__codelineno-1-119 href=#__codelineno-1-119></a><span class=sd>    - Requests: &quot;I need your input on Y&quot;</span>
<a id=__codelineno-1-120 name=__codelineno-1-120 href=#__codelineno-1-120></a>
<a id=__codelineno-1-121 name=__codelineno-1-121 href=#__codelineno-1-121></a><span class=sd>    When NOT to use:</span>
<a id=__codelineno-1-122 name=__codelineno-1-122 href=#__codelineno-1-122></a><span class=sd>    - Responding to user messages (they&#39;re already in the chat)</span>
<a id=__codelineno-1-123 name=__codelineno-1-123 href=#__codelineno-1-123></a><span class=sd>    - Logging/debugging (use internal logs instead)</span>
<a id=__codelineno-1-124 name=__codelineno-1-124 href=#__codelineno-1-124></a><span class=sd>    - High-frequency updates (batch them into summaries)</span>
<a id=__codelineno-1-125 name=__codelineno-1-125 href=#__codelineno-1-125></a>
<a id=__codelineno-1-126 name=__codelineno-1-126 href=#__codelineno-1-126></a><span class=sd>    Examples:</span>
<a id=__codelineno-1-127 name=__codelineno-1-127 href=#__codelineno-1-127></a><span class=sd>        # Simple alert with auto-generated Claude Code link</span>
<a id=__codelineno-1-128 name=__codelineno-1-128 href=#__codelineno-1-128></a><span class=sd>        send_notification(</span>
<a id=__codelineno-1-129 name=__codelineno-1-129 href=#__codelineno-1-129></a><span class=sd>            message=&quot;‚úì Daily briefing complete. 3 meetings today.&quot;</span>
<a id=__codelineno-1-130 name=__codelineno-1-130 href=#__codelineno-1-130></a><span class=sd>        )</span>
<a id=__codelineno-1-131 name=__codelineno-1-131 href=#__codelineno-1-131></a>
<a id=__codelineno-1-132 name=__codelineno-1-132 href=#__codelineno-1-132></a><span class=sd>        # Formatted urgent alert</span>
<a id=__codelineno-1-133 name=__codelineno-1-133 href=#__codelineno-1-133></a><span class=sd>        send_notification(</span>
<a id=__codelineno-1-134 name=__codelineno-1-134 href=#__codelineno-1-134></a><span class=sd>            message=&quot;*URGENT*: Flight UA123 delayed 2 hours\\nNew departure: 10:30 AM&quot;,</span>
<a id=__codelineno-1-135 name=__codelineno-1-135 href=#__codelineno-1-135></a><span class=sd>            parse_mode=&quot;MarkdownV2&quot;,</span>
<a id=__codelineno-1-136 name=__codelineno-1-136 href=#__codelineno-1-136></a><span class=sd>            priority=&quot;critical&quot;</span>
<a id=__codelineno-1-137 name=__codelineno-1-137 href=#__codelineno-1-137></a><span class=sd>        )</span>
<a id=__codelineno-1-138 name=__codelineno-1-138 href=#__codelineno-1-138></a>
<a id=__codelineno-1-139 name=__codelineno-1-139 href=#__codelineno-1-139></a><span class=sd>        # Silent background update</span>
<a id=__codelineno-1-140 name=__codelineno-1-140 href=#__codelineno-1-140></a><span class=sd>        send_notification(</span>
<a id=__codelineno-1-141 name=__codelineno-1-141 href=#__codelineno-1-141></a><span class=sd>            message=&quot;üìã Archived 47 old notes to Diary/2026-01/&quot;,</span>
<a id=__codelineno-1-142 name=__codelineno-1-142 href=#__codelineno-1-142></a><span class=sd>            priority=&quot;silent&quot;</span>
<a id=__codelineno-1-143 name=__codelineno-1-143 href=#__codelineno-1-143></a><span class=sd>        )</span>
<a id=__codelineno-1-144 name=__codelineno-1-144 href=#__codelineno-1-144></a>
<a id=__codelineno-1-145 name=__codelineno-1-145 href=#__codelineno-1-145></a><span class=sd>    Returns:</span>
<a id=__codelineno-1-146 name=__codelineno-1-146 href=#__codelineno-1-146></a><span class=sd>        Confirmation message or error details</span>
<a id=__codelineno-1-147 name=__codelineno-1-147 href=#__codelineno-1-147></a><span class=sd>    &quot;&quot;&quot;</span>
<a id=__codelineno-1-148 name=__codelineno-1-148 href=#__codelineno-1-148></a>    <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-1-149 name=__codelineno-1-149 href=#__codelineno-1-149></a>        <span class=c1># Determine notification sound based on priority</span>
<a id=__codelineno-1-150 name=__codelineno-1-150 href=#__codelineno-1-150></a>        <span class=n>disable_notification</span> <span class=o>=</span> <span class=n>priority</span> <span class=o>==</span> <span class=s2>&quot;silent&quot;</span>
<a id=__codelineno-1-151 name=__codelineno-1-151 href=#__codelineno-1-151></a>
<a id=__codelineno-1-152 name=__codelineno-1-152 href=#__codelineno-1-152></a>        <span class=c1># Auto-generate Hapi URL from session ID</span>
<a id=__codelineno-1-153 name=__codelineno-1-153 href=#__codelineno-1-153></a>        <span class=n>session_link_url</span> <span class=o>=</span> <span class=kc>None</span>
<a id=__codelineno-1-154 name=__codelineno-1-154 href=#__codelineno-1-154></a>        <span class=k>try</span><span class=p>:</span>
<a id=__codelineno-1-155 name=__codelineno-1-155 href=#__codelineno-1-155></a>            <span class=n>session_id</span> <span class=o>=</span> <span class=n>ctx</span><span class=o>.</span><span class=n>session_id</span>
<a id=__codelineno-1-156 name=__codelineno-1-156 href=#__codelineno-1-156></a>            <span class=n>session_link_url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;</span><span class=si>{</span><span class=n>HAPI_BASE_URL</span><span class=si>}</span><span class=s2>/sessions/</span><span class=si>{</span><span class=n>session_id</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-1-157 name=__codelineno-1-157 href=#__codelineno-1-157></a>        <span class=k>except</span> <span class=p>(</span><span class=ne>RuntimeError</span><span class=p>,</span> <span class=ne>AttributeError</span><span class=p>):</span>
<a id=__codelineno-1-158 name=__codelineno-1-158 href=#__codelineno-1-158></a>            <span class=c1># Session ID not available - no link button</span>
<a id=__codelineno-1-159 name=__codelineno-1-159 href=#__codelineno-1-159></a>            <span class=k>pass</span>
<a id=__codelineno-1-160 name=__codelineno-1-160 href=#__codelineno-1-160></a>
<a id=__codelineno-1-161 name=__codelineno-1-161 href=#__codelineno-1-161></a>        <span class=c1># Send via Telegram Bot API</span>
<a id=__codelineno-1-162 name=__codelineno-1-162 href=#__codelineno-1-162></a>        <span class=n>url</span> <span class=o>=</span> <span class=sa>f</span><span class=s2>&quot;https://api.telegram.org/bot</span><span class=si>{</span><span class=n>BOT_TOKEN</span><span class=si>}</span><span class=s2>/sendMessage&quot;</span>
<a id=__codelineno-1-163 name=__codelineno-1-163 href=#__codelineno-1-163></a>        <span class=n>payload</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-1-164 name=__codelineno-1-164 href=#__codelineno-1-164></a>            <span class=s2>&quot;chat_id&quot;</span><span class=p>:</span> <span class=n>CHAT_ID</span><span class=p>,</span>
<a id=__codelineno-1-165 name=__codelineno-1-165 href=#__codelineno-1-165></a>            <span class=s2>&quot;text&quot;</span><span class=p>:</span> <span class=n>message</span><span class=p>,</span>
<a id=__codelineno-1-166 name=__codelineno-1-166 href=#__codelineno-1-166></a>            <span class=s2>&quot;disable_notification&quot;</span><span class=p>:</span> <span class=n>disable_notification</span><span class=p>,</span>
<a id=__codelineno-1-167 name=__codelineno-1-167 href=#__codelineno-1-167></a>        <span class=p>}</span>
<a id=__codelineno-1-168 name=__codelineno-1-168 href=#__codelineno-1-168></a>
<a id=__codelineno-1-169 name=__codelineno-1-169 href=#__codelineno-1-169></a>        <span class=k>if</span> <span class=n>parse_mode</span><span class=p>:</span>
<a id=__codelineno-1-170 name=__codelineno-1-170 href=#__codelineno-1-170></a>            <span class=n>payload</span><span class=p>[</span><span class=s2>&quot;parse_mode&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>parse_mode</span>
<a id=__codelineno-1-171 name=__codelineno-1-171 href=#__codelineno-1-171></a>
<a id=__codelineno-1-172 name=__codelineno-1-172 href=#__codelineno-1-172></a>        <span class=c1># Add session link button if available</span>
<a id=__codelineno-1-173 name=__codelineno-1-173 href=#__codelineno-1-173></a>        <span class=k>if</span> <span class=n>session_link_url</span><span class=p>:</span>
<a id=__codelineno-1-174 name=__codelineno-1-174 href=#__codelineno-1-174></a>            <span class=n>reply_markup</span> <span class=o>=</span> <span class=p>{</span>
<a id=__codelineno-1-175 name=__codelineno-1-175 href=#__codelineno-1-175></a>                <span class=s2>&quot;inline_keyboard&quot;</span><span class=p>:</span> <span class=p>[[{</span><span class=s2>&quot;text&quot;</span><span class=p>:</span> <span class=s2>&quot;View in Claude Code&quot;</span><span class=p>,</span> <span class=s2>&quot;url&quot;</span><span class=p>:</span> <span class=n>session_link_url</span><span class=p>}]]</span>
<a id=__codelineno-1-176 name=__codelineno-1-176 href=#__codelineno-1-176></a>            <span class=p>}</span>
<a id=__codelineno-1-177 name=__codelineno-1-177 href=#__codelineno-1-177></a>            <span class=n>payload</span><span class=p>[</span><span class=s2>&quot;reply_markup&quot;</span><span class=p>]</span> <span class=o>=</span> <span class=n>reply_markup</span>
<a id=__codelineno-1-178 name=__codelineno-1-178 href=#__codelineno-1-178></a>
<a id=__codelineno-1-179 name=__codelineno-1-179 href=#__codelineno-1-179></a>        <span class=n>response</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>json</span><span class=o>=</span><span class=n>payload</span><span class=p>,</span> <span class=n>timeout</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<a id=__codelineno-1-180 name=__codelineno-1-180 href=#__codelineno-1-180></a>        <span class=n>response</span><span class=o>.</span><span class=n>raise_for_status</span><span class=p>()</span>
<a id=__codelineno-1-181 name=__codelineno-1-181 href=#__codelineno-1-181></a>
<a id=__codelineno-1-182 name=__codelineno-1-182 href=#__codelineno-1-182></a>        <span class=n>link_info</span> <span class=o>=</span> <span class=s2>&quot; with link&quot;</span> <span class=k>if</span> <span class=n>session_link_url</span> <span class=k>else</span> <span class=s2>&quot;&quot;</span>
<a id=__codelineno-1-183 name=__codelineno-1-183 href=#__codelineno-1-183></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;‚úì Notification</span><span class=si>{</span><span class=n>link_info</span><span class=si>}</span><span class=s2> sent successfully (</span><span class=si>{</span><span class=n>priority</span><span class=si>}</span><span class=s2>)&quot;</span>
<a id=__codelineno-1-184 name=__codelineno-1-184 href=#__codelineno-1-184></a>
<a id=__codelineno-1-185 name=__codelineno-1-185 href=#__codelineno-1-185></a>    <span class=k>except</span> <span class=n>requests</span><span class=o>.</span><span class=n>exceptions</span><span class=o>.</span><span class=n>RequestException</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
<a id=__codelineno-1-186 name=__codelineno-1-186 href=#__codelineno-1-186></a>        <span class=k>return</span> <span class=sa>f</span><span class=s2>&quot;‚úó Failed to send notification: </span><span class=si>{</span><span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span><span class=si>}</span><span class=s2>&quot;</span>
<a id=__codelineno-1-187 name=__codelineno-1-187 href=#__codelineno-1-187></a>
<a id=__codelineno-1-188 name=__codelineno-1-188 href=#__codelineno-1-188></a>
<a id=__codelineno-1-189 name=__codelineno-1-189 href=#__codelineno-1-189></a><span class=c1># ============================================================================</span>
<a id=__codelineno-1-190 name=__codelineno-1-190 href=#__codelineno-1-190></a><span class=c1># Server Entry Point</span>
<a id=__codelineno-1-191 name=__codelineno-1-191 href=#__codelineno-1-191></a><span class=c1># ============================================================================</span>
<a id=__codelineno-1-192 name=__codelineno-1-192 href=#__codelineno-1-192></a>
<a id=__codelineno-1-193 name=__codelineno-1-193 href=#__codelineno-1-193></a><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&quot;__main__&quot;</span><span class=p>:</span>
<a id=__codelineno-1-194 name=__codelineno-1-194 href=#__codelineno-1-194></a>    <span class=n>mcp</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</code></pre></div> <hr> <h2 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h2> <h3 id=mcp-client-configuration>MCP Client Configuration<a class=headerlink href=#mcp-client-configuration title="Permanent link">&para;</a></h3> <p>Add to <code>~/.config/claude-code/mcp_config.json</code>:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=p>{</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a><span class=w>  </span><span class=nt>&quot;mcpServers&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=w>    </span><span class=nt>&quot;pulse-queue&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=w>      </span><span class=nt>&quot;command&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uv&quot;</span><span class=p>,</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>      </span><span class=nt>&quot;args&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>        </span><span class=s2>&quot;run&quot;</span><span class=p>,</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>        </span><span class=s2>&quot;--directory&quot;</span><span class=p>,</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=w>        </span><span class=s2>&quot;/home/reuben/workspace/reeve-bot&quot;</span><span class=p>,</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=w>        </span><span class=s2>&quot;python&quot;</span><span class=p>,</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=w>        </span><span class=s2>&quot;-m&quot;</span><span class=p>,</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=w>        </span><span class=s2>&quot;reeve.mcp.pulse_server&quot;</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=w>      </span><span class=p>],</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=w>      </span><span class=nt>&quot;env&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=w>        </span><span class=nt>&quot;PULSE_DB_PATH&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;/home/reuben/.reeve/pulse_queue.db&quot;</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=w>    </span><span class=p>},</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a><span class=w>    </span><span class=nt>&quot;telegram-notifier&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-18 name=__codelineno-2-18 href=#__codelineno-2-18></a><span class=w>      </span><span class=nt>&quot;command&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;uv&quot;</span><span class=p>,</span>
<a id=__codelineno-2-19 name=__codelineno-2-19 href=#__codelineno-2-19></a><span class=w>      </span><span class=nt>&quot;args&quot;</span><span class=p>:</span><span class=w> </span><span class=p>[</span>
<a id=__codelineno-2-20 name=__codelineno-2-20 href=#__codelineno-2-20></a><span class=w>        </span><span class=s2>&quot;run&quot;</span><span class=p>,</span>
<a id=__codelineno-2-21 name=__codelineno-2-21 href=#__codelineno-2-21></a><span class=w>        </span><span class=s2>&quot;--directory&quot;</span><span class=p>,</span>
<a id=__codelineno-2-22 name=__codelineno-2-22 href=#__codelineno-2-22></a><span class=w>        </span><span class=s2>&quot;/home/reuben/workspace/reeve-bot&quot;</span><span class=p>,</span>
<a id=__codelineno-2-23 name=__codelineno-2-23 href=#__codelineno-2-23></a><span class=w>        </span><span class=s2>&quot;python&quot;</span><span class=p>,</span>
<a id=__codelineno-2-24 name=__codelineno-2-24 href=#__codelineno-2-24></a><span class=w>        </span><span class=s2>&quot;-m&quot;</span><span class=p>,</span>
<a id=__codelineno-2-25 name=__codelineno-2-25 href=#__codelineno-2-25></a><span class=w>        </span><span class=s2>&quot;reeve.mcp.notification_server&quot;</span>
<a id=__codelineno-2-26 name=__codelineno-2-26 href=#__codelineno-2-26></a><span class=w>      </span><span class=p>],</span>
<a id=__codelineno-2-27 name=__codelineno-2-27 href=#__codelineno-2-27></a><span class=w>      </span><span class=nt>&quot;env&quot;</span><span class=p>:</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-2-28 name=__codelineno-2-28 href=#__codelineno-2-28></a><span class=w>        </span><span class=nt>&quot;TELEGRAM_BOT_TOKEN&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;your_bot_token_here&quot;</span><span class=p>,</span>
<a id=__codelineno-2-29 name=__codelineno-2-29 href=#__codelineno-2-29></a><span class=w>        </span><span class=nt>&quot;TELEGRAM_CHAT_ID&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;your_chat_id_here&quot;</span><span class=p>,</span>
<a id=__codelineno-2-30 name=__codelineno-2-30 href=#__codelineno-2-30></a><span class=w>        </span><span class=nt>&quot;HAPI_BASE_URL&quot;</span><span class=p>:</span><span class=w> </span><span class=s2>&quot;https://hapi.run&quot;</span>
<a id=__codelineno-2-31 name=__codelineno-2-31 href=#__codelineno-2-31></a><span class=w>      </span><span class=p>}</span>
<a id=__codelineno-2-32 name=__codelineno-2-32 href=#__codelineno-2-32></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-2-33 name=__codelineno-2-33 href=#__codelineno-2-33></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-2-34 name=__codelineno-2-34 href=#__codelineno-2-34></a><span class=p>}</span>
</code></pre></div> <p><strong>Security Note</strong>: The bot token is sensitive. Consider using a secrets manager or environment variable injection instead of hardcoding in the config.</p> <h3 id=environment-variables>Environment Variables<a class=headerlink href=#environment-variables title="Permanent link">&para;</a></h3> <p><strong>Required</strong>: - <code>TELEGRAM_BOT_TOKEN</code>: Bot API token from @BotFather - <code>TELEGRAM_CHAT_ID</code>: User's chat ID (get from /start message)</p> <p><strong>Optional</strong>: - <code>PULSE_DB_PATH</code>: Path to SQLite database (default: <code>~/.reeve/pulse_queue.db</code>) - <code>HAPI_BASE_URL</code>: Base URL for Hapi sessions (default: <code>https://hapi.run</code>)</p> <h2 id=design-principles>Design Principles<a class=headerlink href=#design-principles title="Permanent link">&para;</a></h2> <h3 id=1-type-safety-with-pydantic>1. Type Safety with Pydantic<a class=headerlink href=#1-type-safety-with-pydantic title="Permanent link">&para;</a></h3> <p>All tool parameters use <code>Annotated[Type, Field(...)]</code> to provide: - Runtime validation (Pydantic) - IDE autocomplete - Auto-generated MCP documentation - Clear error messages</p> <h3 id=2-comprehensive-documentation>2. Comprehensive Documentation<a class=headerlink href=#2-comprehensive-documentation title="Permanent link">&para;</a></h3> <p>Each tool has: - <strong>Docstring</strong>: High-level purpose and usage - <strong>Field descriptions</strong>: Detailed parameter explanations - <strong>Examples</strong>: Concrete use cases - <strong>When to use / When NOT to use</strong>: Decision guidance</p> <p>This helps Reeve (Claude) make intelligent decisions about when to call tools.</p> <h3 id=3-user-friendly-formatting>3. User-Friendly Formatting<a class=headerlink href=#3-user-friendly-formatting title="Permanent link">&para;</a></h3> <ul> <li><strong>Emojis</strong>: Visual priority/status indicators</li> <li><strong>Relative times</strong>: "in 2 hours" vs. ISO timestamps</li> <li><strong>Concise output</strong>: Essential info only, no clutter</li> </ul> <h3 id=4-error-handling>4. Error Handling<a class=headerlink href=#4-error-handling title="Permanent link">&para;</a></h3> <ul> <li><strong>Graceful failures</strong>: Return error strings, don't raise exceptions</li> <li><strong>Actionable messages</strong>: "Could not cancel pulse (not found)" vs. "Error 404"</li> <li><strong>Success confirmation</strong>: Always confirm what happened</li> </ul> <h2 id=testing-mcp-tools>Testing MCP Tools<a class=headerlink href=#testing-mcp-tools title="Permanent link">&para;</a></h2> <h3 id=manual-testing>Manual Testing<a class=headerlink href=#manual-testing title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=c1># Terminal 1: Start MCP server</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>uv<span class=w> </span>run<span class=w> </span>python<span class=w> </span>-m<span class=w> </span>reeve.mcp.pulse_server
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=c1># Terminal 2: Send test input (MCP JSON-RPC protocol)</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=nb>echo</span><span class=w> </span><span class=s1>&#39;{</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=s1>  &quot;jsonrpc&quot;: &quot;2.0&quot;,</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=s1>  &quot;id&quot;: 1,</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=s1>  &quot;method&quot;: &quot;tools/call&quot;,</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=s1>  &quot;params&quot;: {</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=s1>    &quot;name&quot;: &quot;schedule_pulse&quot;,</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=s1>    &quot;arguments&quot;: {</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=s1>      &quot;scheduled_at&quot;: &quot;in 5 minutes&quot;,</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=s1>      &quot;prompt&quot;: &quot;Test pulse&quot;,</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=s1>      &quot;priority&quot;: &quot;normal&quot;</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=s1>    }</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=s1>  }</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=s1>}&#39;</span><span class=w> </span><span class=p>|</span><span class=w> </span>uv<span class=w> </span>run<span class=w> </span>python<span class=w> </span>-m<span class=w> </span>reeve.mcp.pulse_server
</code></pre></div> <h3 id=integration-testing>Integration Testing<a class=headerlink href=#integration-testing title="Permanent link">&para;</a></h3> <p>Use the Hapi/Claude Code test environment to call tools and verify behavior.</p> <h2 id=next-steps>Next Steps<a class=headerlink href=#next-steps title="Permanent link">&para;</a></h2> <p>See <strong><a href=../deployment/ >deployment.md</a></strong> for production deployment, systemd configuration, and monitoring setup.</p> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.instant", "navigation.tracking", "navigation.sections", "navigation.expand", "search.suggest", "search.highlight", "content.code.copy"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=https://unpkg.com/mermaid@10/dist/mermaid.min.js></script> </body> </html>